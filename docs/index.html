<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive BOM for KiCAD</title>
  <style type="text/css">
:root {
  --pcb-edge-color: black;
  --pad-color: #878787;
  --pad-hole-color: #CCCCCC;
  --pad-color-highlight: #D04040;
  --pad-color-highlight-both: #D0D040;
  --pad-color-highlight-marked: #44a344;
  --pin1-outline-color: #ffb629;
  --pin1-outline-color-highlight: #ffb629;
  --pin1-outline-color-highlight-both: #fcbb39;
  --pin1-outline-color-highlight-marked: #fdbe41;
  --silkscreen-edge-color: #aa4;
  --silkscreen-polygon-color: #4aa;
  --silkscreen-text-color: #4aa;
  --fabrication-edge-color: #907651;
  --fabrication-polygon-color: #907651;
  --fabrication-text-color: #a27c24;
  --track-color: #def5f1;
  --track-color-highlight: #D04040;
  --zone-color: #def5f1;
  --zone-color-highlight: #d0404080;
}

html,
body {
  margin: 0px;
  height: 100%;
  font-family: Verdana, sans-serif;
}

.dark.topmostdiv {
  --pcb-edge-color: #eee;
  --pad-color: #808080;
  --pin1-outline-color: #ffa800;
  --pin1-outline-color-highlight: #ccff00;
  --track-color: #42524f;
  --zone-color: #42524f;
  background-color: #252c30;
  color: #eee;
}

button {
  background-color: #eee;
  border: 1px solid #888;
  color: black;
  height: 44px;
  width: 44px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
  font-weight: bolder;
}

.dark button {
  /* This will be inverted */
  background-color: #c3b7b5;
}

button.depressed {
  background-color: #0a0;
  color: white;
}

.dark button.depressed {
  /* This will be inverted */
  background-color: #b3b;
}

button:focus {
  outline: 0;
}

button#tb-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.32 290.12h5.82M1.32 291.45h5.82' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 292.5v4.23M.26 292.63H8.2' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='1.35' y='295.73'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#lr-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.06 290.12H3.7m-2.64 1.33H3.7m-2.64 1.32H3.7m-2.64 1.3H3.7m-2.64 1.33H3.7' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 288.8v7.94m0-4.11h3.96' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='5.11' y='291.96'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#bom-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)' fill='none' stroke='%23000' stroke-width='.4'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' stroke-linejoin='round'/%3E%3Cpath d='M1.59 290.12h5.29M1.59 291.45h5.33M1.59 292.75h5.33M1.59 294.09h5.33M1.59 295.41h5.33'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-grouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m4 0h5m4 0h3M6.1 22h3m3.9 0h5m4 0h4m-16-8h4m4 0h4'/%3E%3Cpath stroke-linecap='null' d='M5 17.5h22M5 26.6h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-ungrouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m-4 8h3m-3 8h4'/%3E%3Cpath stroke-linecap='null' d='M5 13.5h22m-22 8h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-netlist-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg fill='none' stroke='%23000' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-width='2' d='M6 26l6-6v-8m13.8-6.3l-6 6v8'/%3E%3Ccircle cx='11.8' cy='9.5' r='2.8' stroke-width='2'/%3E%3Ccircle cx='19.8' cy='22.8' r='2.8' stroke-width='2'/%3E%3C/g%3E%3C/svg%3E");
}

button#copy {
  background-image: url("data:image/svg+xml,%3Csvg height='48' viewBox='0 0 48 48' width='48' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h48v48h-48z' fill='none'/%3E%3Cpath d='M32 2h-24c-2.21 0-4 1.79-4 4v28h4v-28h24v-4zm6 8h-22c-2.21 0-4 1.79-4 4v28c0 2.21 1.79 4 4 4h22c2.21 0 4-1.79 4-4v-28c0-2.21-1.79-4-4-4zm0 32h-22v-28h22v28z'/%3E%3C/svg%3E");
  background-position: 6px 6px;
  background-repeat: no-repeat;
  background-size: 26px 26px;
  border-radius: 6px;
  height: 40px;
  width: 40px;
  margin: 10px 5px;
}

button#copy:active {
  box-shadow: inset 0px 0px 5px #6c6c6c;
}

textarea.clipboard-temp {
  position: fixed;
  top: 0;
  left: 0;
  width: 2em;
  height: 2em;
  padding: 0;
  border: None;
  outline: None;
  box-shadow: None;
  background: transparent;
}

.left-most-button {
  border-right: 0;
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
}

.middle-button {
  border-right: 0;
}

.right-most-button {
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
}

.button-container {
  font-size: 0;
  margin: 0.4rem 0.4rem 0.4rem 0;
}

.dark .button-container {
  filter: invert(1);
}

.button-container button {
  background-size: 32px 32px;
  background-position: 5px 5px;
  background-repeat: no-repeat;
}

@media print {
  .hideonprint {
    display: none;
  }
}

canvas {
  cursor: crosshair;
}

canvas:active {
  cursor: grabbing;
}

.fileinfo {
  width: 100%;
  max-width: 1000px;
  border: none;
  padding: 3px;
}

.fileinfo .title {
  font-size: 20pt;
  font-weight: bold;
}

.fileinfo td {
  overflow: hidden;
  white-space: nowrap;
  max-width: 1px;
  width: 50%;
  text-overflow: ellipsis;
}

.bom {
  border-collapse: collapse;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 10pt;
  table-layout: fixed;
  width: 100%;
  margin-top: 1px;
  position: relative;
}

.bom th,
.bom td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

.dark .bom th,
.dark .bom td {
  border: 1px solid #777;
}

.bom th {
  background-color: #CCCCCC;
  background-clip: padding-box;
}

.dark .bom th {
  background-color: #3b4749;
}

.bom tr.highlighted:nth-child(n) {
  background-color: #cfc;
}

.dark .bom tr.highlighted:nth-child(n) {
  background-color: #226022;
}

.bom tr:nth-child(even) {
  background-color: #f2f2f2;
}

.dark .bom tr:nth-child(even) {
  background-color: #313b40;
}

.bom tr.checked {
  color: #1cb53d;
}

.dark .bom tr.checked {
  color: #2cce54;
}

.bom tr {
  transition: background-color 0.2s;
}

.bom .numCol {
  width: 30px;
}

.bom .value {
  width: 15%;
}

.bom .quantity {
  width: 65px;
}

.bom th .sortmark {
  position: absolute;
  right: 1px;
  top: 1px;
  margin-top: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #221 transparent;
  transform-origin: 50% 85%;
  transition: opacity 0.2s, transform 0.4s;
}

.dark .bom th .sortmark {
  filter: invert(1);
}

.bom th .sortmark.none {
  opacity: 0;
}

.bom th .sortmark.desc {
  transform: rotate(180deg);
}

.bom th:hover .sortmark.none {
  opacity: 0.5;
}

.bom .bom-checkbox {
  width: 30px;
  position: relative;
  user-select: none;
  -moz-user-select: none;
}

.bom .bom-checkbox:before {
  content: "";
  position: absolute;
  border-width: 15px;
  border-style: solid;
  border-color: #51829f transparent transparent transparent;
  visibility: hidden;
  top: -15px;
}

.bom .bom-checkbox:after {
  content: "Double click to set/unset all";
  position: absolute;
  color: white;
  top: -35px;
  left: -26px;
  background: #51829f;
  padding: 5px 15px;
  border-radius: 8px;
  white-space: nowrap;
  visibility: hidden;
}

.bom .bom-checkbox:hover:before,
.bom .bom-checkbox:hover:after {
  visibility: visible;
  transition: visibility 0.2s linear 1s;
}

.split {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  overflow-y: auto;
  overflow-x: hidden;
  background-color: inherit;
}

.split.split-horizontal,
.gutter.gutter-horizontal {
  height: 100%;
  float: left;
}

.gutter {
  background-color: #ddd;
  background-repeat: no-repeat;
  background-position: 50%;
  transition: background-color 0.3s;
}

.dark .gutter {
  background-color: #777;
}

.gutter.gutter-horizontal {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==');
  cursor: ew-resize;
  width: 5px;
}

.gutter.gutter-vertical {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=');
  cursor: ns-resize;
  height: 5px;
}

.searchbox {
  float: left;
  height: 40px;
  margin: 10px 5px;
  padding: 12px 32px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 18px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 6px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABNklEQVQ4T8XSMUvDQBQH8P/LElFa/AIZHcTBQSz0I/gFstTBRR2KUC4ldDxw7h0Bl3RRUATxi4iiODgoiLNrbQYp5J6cpJJqomkX33Z37/14d/dIa33MzDuYI4johOI4XhyNRteO46zNYjDzAxE1yBZprVeZ+QbAUhXEGJMA2Ox2u4+fQIa0mPmsCgCgJYQ4t7lfgF0opQYAdv9ABkKI/UnOFCClXKjX61cA1osQY8x9kiRNKeV7IWA3oyhaSdP0FkAtjxhj3hzH2RBCPOf3pzqYHCilfAAX+URm9oMguPzeWSGQvUcMYC8rOBJCHBRdqxTo9/vbRHRqi8bj8XKv1xvODbiuW2u32/bvf0SlDv4XYOY7z/Mavu+nM1+BmQ+NMc0wDF/LprP0DbTWW0T00ul0nn4b7Q87+X4Qmfiq2wAAAABJRU5ErkJggg==');
  background-position: 10px 10px;
  background-repeat: no-repeat;
}

.dark .searchbox {
  background-color: #111;
  color: #eee;
}

.searchbox::placeholder {
  color: #ccc;
}

.dark .searchbox::placeholder {
  color: #666;
}

.filter {
  width: calc(60% - 64px);
}

.reflookup {
  width: calc(40% - 10px);
}

input[type=text]:focus {
  background-color: white;
  border: 1px solid #333;
}

.dark input[type=text]:focus {
  background-color: #333;
  border: 1px solid #ccc;
}

mark.highlight {
  background-color: #5050ff;
  color: #fff;
  padding: 2px;
  border-radius: 6px;
}

.dark mark.highlight {
  background-color: #76a6da;
  color: #111;
}

.menubtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36' viewBox='0 0 20 20'%3E%3Cpath fill='none' d='M0 0h20v20H0V0z'/%3E%3Cpath d='M15.95 10.78c.03-.25.05-.51.05-.78s-.02-.53-.06-.78l1.69-1.32c.15-.12.19-.34.1-.51l-1.6-2.77c-.1-.18-.31-.24-.49-.18l-1.99.8c-.42-.32-.86-.58-1.35-.78L12 2.34c-.03-.2-.2-.34-.4-.34H8.4c-.2 0-.36.14-.39.34l-.3 2.12c-.49.2-.94.47-1.35.78l-1.99-.8c-.18-.07-.39 0-.49.18l-1.6 2.77c-.1.18-.06.39.1.51l1.69 1.32c-.04.25-.07.52-.07.78s.02.53.06.78L2.37 12.1c-.15.12-.19.34-.1.51l1.6 2.77c.1.18.31.24.49.18l1.99-.8c.42.32.86.58 1.35.78l.3 2.12c.04.2.2.34.4.34h3.2c.2 0 .37-.14.39-.34l.3-2.12c.49-.2.94-.47 1.35-.78l1.99.8c.18.07.39 0 .49-.18l1.6-2.77c.1-.18.06-.39-.1-.51l-1.67-1.32zM10 13c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z'/%3E%3C/svg%3E%0A");
  background-position: center;
  background-repeat: no-repeat;
}

.statsbtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg width='36' height='36' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4 6h28v24H4V6zm0 8h28v8H4m9-16v24h10V5.8' fill='none' stroke='%23000' stroke-width='2'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.iobtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36'%3E%3Cpath fill='none' stroke='%23000' stroke-width='2' d='M3 33v-7l6.8-7h16.5l6.7 7v7H3zM3.2 26H33M21 9l5-5.9 5 6h-2.5V15h-5V9H21zm-4.9 0l-5 6-5-6h2.5V3h5v6h2.5z'/%3E%3Cpath fill='none' stroke='%23000' d='M6.1 29.5H10'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.visbtn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' stroke='%23333' d='M2.5 4.5h5v15h-5zM9.5 4.5h5v15h-5zM16.5 4.5h5v15h-5z'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
  padding: 15px;
}

#vismenu-content {
  left: 0px;
  font-family: Verdana, sans-serif;
}

.dark .statsbtn,
.dark .savebtn,
.dark .menubtn,
.dark .iobtn,
.dark .visbtn {
  filter: invert(1);
}

.flexbox {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.savebtn {
  background-color: #d6d6d6;
  width: auto;
  height: 30px;
  flex-grow: 1;
  margin: 5px;
  border-radius: 4px;
}

.savebtn:active {
  background-color: #0a0;
  color: white;
}

.dark .savebtn:active {
  /* This will be inverted */
  background-color: #b3b;
}

.stats {
  border-collapse: collapse;
  font-size: 12pt;
  table-layout: fixed;
  width: 100%;
  min-width: 450px;
}

.dark .stats td {
  border: 1px solid #bbb;
}

.stats td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

#checkbox-stats div {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

#checkbox-stats .bar {
  background-color: rgba(28, 251, 0, 0.6);
}

.menu {
  position: relative;
  display: inline-block;
  margin: 0.4rem 0.4rem 0.4rem 0;
}

.menu-content {
  font-size: 12pt !important;
  text-align: left !important;
  font-weight: normal !important;
  display: none;
  position: absolute;
  background-color: white;
  right: 0;
  min-width: 300px;
  box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
  z-index: 100;
  padding: 8px;
}

.dark .menu-content {
  background-color: #111;
}

.menu:hover .menu-content {
  display: block;
}

.menu:hover .menubtn,
.menu:hover .iobtn,
.menu:hover .statsbtn {
  background-color: #eee;
}

.menu-label {
  display: inline-block;
  padding: 8px;
  border: 1px solid #ccc;
  border-top: 0;
  width: calc(100% - 18px);
}

.menu-label-top {
  border-top: 1px solid #ccc;
}

.menu-textbox {
  float: left;
  height: 24px;
  margin: 10px 5px;
  padding: 5px 5px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 14px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 4px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  width: calc(100% - 10px);
}

.menu-textbox.invalid,
.dark .menu-textbox.invalid {
  color: red;
}

.dark .menu-textbox {
  background-color: #222;
  color: #eee;
}

.radio-container {
  margin: 4px;
}

.topmostdiv {
  display: flex;
  flex-direction: column;
  width: 100%;
  background-color: white;
  transition: background-color 0.3s;
}

#top {
  display: flex;
  flex-wrap: wrap;
  justify-content: flex-end;
  align-items: center;
}

#topdivider {
  border-bottom: 2px solid black;
  display: flex;
  justify-content: center;
  align-items: center;
}

.dark #topdivider {
  border-bottom: 2px solid #ccc;
}

#topdivider>div {
  position: relative;
}

#toptoggle {
  cursor: pointer;
  user-select: none;
  position: absolute;
  padding: 0.1rem 0.3rem;
  top: -0.4rem;
  left: -1rem;
  font-size: 1.4rem;
  line-height: 60%;
  border: 1px solid black;
  border-radius: 1rem;
  background-color: #fff;
  z-index: 100;
}

.flipped {
  transform: rotate(0.5turn);
}

.dark #toptoggle {
  border: 1px solid #fff;
  background-color: #222;
}

#fileinfodiv {
  flex: 20rem 1 0;
  overflow: auto;
}

#bomcontrols {
  display: flex;
  flex-direction: row-reverse;
}

#bomcontrols>* {
  flex-shrink: 0;
}

#dbg {
  display: block;
}

::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #aaa;
}

::-webkit-scrollbar-thumb {
  background: #666;
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.slider {
  -webkit-appearance: none;
  width: 100%;
  margin: 3px 0;
  padding: 0;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
  border-radius: 3px;
}

.slider:hover {
  opacity: 1;
}

.slider:focus {
  outline: none;
}

.slider::-webkit-slider-runnable-track {
  -webkit-appearance: none;
  width: 100%;
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
  border: none;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin-top: -4px;
}

.dark .slider::-webkit-slider-thumb {
  background: #3d3;
}

.slider::-moz-range-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
}

.slider::-moz-range-track {
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
}

.dark .slider::-moz-range-thumb {
  background: #3d3;
}

.slider::-ms-track {
  width: 100%;
  height: 8px;
  border-width: 3px 0;
  background: transparent;
  border-color: transparent;
  color: transparent;
  transition: opacity .2s;
}

.slider::-ms-fill-lower {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-fill-upper {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin: 0;
}

.shameless-plug {
  font-size: 0.8em;
  text-align: center;
  display: block;
}

a {
  color: #0278a4;
}

.dark a {
  color: #00b9fd;
}

#frontcanvas,
#backcanvas {
  touch-action: none;
}

.placeholder {
  border: 1px dashed #9f9fda !important;
  background-color: #edf2f7 !important;
}

.dragging {
  z-index: 999;
}

.dark .dragging>table>tbody>tr {
  background-color: #252c30;
}

.dark .placeholder {
  filter: invert(1);
}

.column-spacer {
  top: 0;
  left: 0;
  width: calc(100% - 4px);
  position: absolute;
  cursor: pointer;
  user-select: none;
  height: 100%;
}

.column-width-handle {
  top: 0;
  right: 0;
  width: 4px;
  position: absolute;
  cursor: col-resize;
  user-select: none;
  height: 100%;
}

.column-width-handle:hover {
  background-color: #4f99bd;
}

.help-link {
  border: 1px solid #0278a4;
  padding-inline: 0.3rem;
  border-radius: 3px;
  cursor: pointer;
}

.dark .help-link {
  border: 1px solid #00b9fd;
}

.bom-color {
  width: 20%;
}

.color-column input {
  width: 1.6rem;
  height: 1rem;
  border: 1px solid black;
  cursor: pointer;
  padding: 0;
}

/* removes default styling from input color element */
::-webkit-color-swatch {
  border: none;
}

::-webkit-color-swatch-wrapper {
  padding: 0;
}

::-moz-color-swatch,
::-moz-focus-inner {
  border: none;
}

::-moz-focus-inner {
  padding: 0;
}
/* #bomhead {
    position: sticky;
    top: 0px;
    z-index: 1;
} */
  </style>
  <script type="text/javascript" >
///////////////////////////////////////////////
/*
  Split.js - v1.3.5
  MIT License
  https://github.com/nathancahill/Split.js
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Split=t()}(this,function(){"use strict";var e=window,t=e.document,n="addEventListener",i="removeEventListener",r="getBoundingClientRect",s=function(){return!1},o=e.attachEvent&&!e[n],a=["","-webkit-","-moz-","-o-"].filter(function(e){var n=t.createElement("div");return n.style.cssText="width:"+e+"calc(9px)",!!n.style.length}).shift()+"calc",l=function(e){return"string"==typeof e||e instanceof String?t.querySelector(e):e};return function(u,c){function z(e,t,n){var i=A(y,t,n);Object.keys(i).forEach(function(t){return e.style[t]=i[t]})}function h(e,t){var n=B(y,t);Object.keys(n).forEach(function(t){return e.style[t]=n[t]})}function f(e){var t=E[this.a],n=E[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,z(t.element,t.size,this.aGutterSize),z(n.element,n.size,this.bGutterSize)}function m(e){var t;this.dragging&&((t="touches"in e?e.touches[0][b]-this.start:e[b]-this.start)<=E[this.a].minSize+M+this.aGutterSize?t=E[this.a].minSize+this.aGutterSize:t>=this.size-(E[this.b].minSize+M+this.bGutterSize)&&(t=this.size-(E[this.b].minSize+this.bGutterSize)),f.call(this,t),c.onDrag&&c.onDrag())}function g(){var e=E[this.a].element,t=E[this.b].element;this.size=e[r]()[y]+t[r]()[y]+this.aGutterSize+this.bGutterSize,this.start=e[r]()[G]}function d(){var t=this,n=E[t.a].element,r=E[t.b].element;t.dragging&&c.onDragEnd&&c.onDragEnd(),t.dragging=!1,e[i]("mouseup",t.stop),e[i]("touchend",t.stop),e[i]("touchcancel",t.stop),t.parent[i]("mousemove",t.move),t.parent[i]("touchmove",t.move),delete t.stop,delete t.move,n[i]("selectstart",s),n[i]("dragstart",s),r[i]("selectstart",s),r[i]("dragstart",s),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",t.gutter.style.cursor="",t.parent.style.cursor=""}function S(t){var i=this,r=E[i.a].element,o=E[i.b].element;!i.dragging&&c.onDragStart&&c.onDragStart(),t.preventDefault(),i.dragging=!0,i.move=m.bind(i),i.stop=d.bind(i),e[n]("mouseup",i.stop),e[n]("touchend",i.stop),e[n]("touchcancel",i.stop),i.parent[n]("mousemove",i.move),i.parent[n]("touchmove",i.move),r[n]("selectstart",s),r[n]("dragstart",s),o[n]("selectstart",s),o[n]("dragstart",s),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",i.gutter.style.cursor=j,i.parent.style.cursor=j,g.call(i)}function v(e){e.forEach(function(t,n){if(n>0){var i=F[n-1],r=E[i.a],s=E[i.b];r.size=e[n-1],s.size=t,z(r.element,r.size,i.aGutterSize),z(s.element,s.size,i.bGutterSize)}})}function p(){F.forEach(function(e){e.parent.removeChild(e.gutter),E[e.a].element.style[y]="",E[e.b].element.style[y]=""})}void 0===c&&(c={});var y,b,G,E,w=l(u[0]).parentNode,D=e.getComputedStyle(w).flexDirection,U=c.sizes||u.map(function(){return 100/u.length}),k=void 0!==c.minSize?c.minSize:100,x=Array.isArray(k)?k:u.map(function(){return k}),L=void 0!==c.gutterSize?c.gutterSize:10,M=void 0!==c.snapOffset?c.snapOffset:30,O=c.direction||"horizontal",j=c.cursor||("horizontal"===O?"ew-resize":"ns-resize"),C=c.gutter||function(e,n){var i=t.createElement("div");return i.className="gutter gutter-"+n,i},A=c.elementStyle||function(e,t,n){var i={};return"string"==typeof t||t instanceof String?i[e]=t:i[e]=o?t+"%":a+"("+t+"% - "+n+"px)",i},B=c.gutterStyle||function(e,t){return n={},n[e]=t+"px",n;var n};"horizontal"===O?(y="width","clientWidth",b="clientX",G="left","paddingLeft"):"vertical"===O&&(y="height","clientHeight",b="clientY",G="top","paddingTop");var F=[];return E=u.map(function(e,t){var i,s={element:l(e),size:U[t],minSize:x[t]};if(t>0&&(i={a:t-1,b:t,dragging:!1,isFirst:1===t,isLast:t===u.length-1,direction:O,parent:w},i.aGutterSize=L,i.bGutterSize=L,i.isFirst&&(i.aGutterSize=L/2),i.isLast&&(i.bGutterSize=L/2),"row-reverse"===D||"column-reverse"===D)){var a=i.a;i.a=i.b,i.b=a}if(!o&&t>0){var c=C(t,O);h(c,L),c[n]("mousedown",S.bind(i)),c[n]("touchstart",S.bind(i)),w.insertBefore(c,s.element),i.gutter=c}0===t||t===u.length-1?z(s.element,s.size,L/2):z(s.element,s.size,L);var f=s.element[r]()[y];return f<s.minSize&&(s.minSize=f),t>0&&F.push(i),s}),o?{setSizes:v,destroy:p}:{setSizes:v,getSizes:function(){return E.map(function(e){return e.size})},collapse:function(e){if(e===F.length){var t=F[e-1];g.call(t),o||f.call(t,t.size-t.bGutterSize)}else{var n=F[e];g.call(n),o||f.call(n,n.aGutterSize)}},destroy:p}}});

///////////////////////////////////////////////

///////////////////////////////////////////////
// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
// This work is free. You can redistribute it and/or modify it
// under the terms of the WTFPL, Version 2
// For more information see LICENSE.txt or http://www.wtfpl.net/
//
// For more information, the home page:
// http://pieroxy.net/blog/pages/lz-string/testing.html
//
// LZ-based compression algorithm, version 1.4.4
var LZString=function(){var o=String.fromCharCode,i={};var n={decompressFromBase64:function(o){return null==o?"":""==o?null:n._decompress(o.length,32,function(n){return function(o,n){if(!i[o]){i[o]={};for(var t=0;t<o.length;t++)i[o][o.charAt(t)]=t}return i[o][n]}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o.charAt(n))})},_decompress:function(i,n,t){var r,e,a,s,p,u,l,f=[],c=4,d=4,h=3,v="",g=[],m={val:t(0),position:n,index:1};for(r=0;r<3;r+=1)f[r]=r;for(a=0,p=Math.pow(2,2),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 2:return""}for(f[3]=l,e=l,g.push(l);;){if(m.index>i)return"";for(a=0,p=Math.pow(2,h),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 2:return g.join("")}if(0==c&&(c=Math.pow(2,h),h++),f[l])v=f[l];else{if(l!==d)return null;v=e+e.charAt(0)}g.push(v),f[d++]=e+v.charAt(0),e=v,0==--c&&(c=Math.pow(2,h),h++)}}};return n}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module?module.exports=LZString:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",function(){return LZString});
///////////////////////////////////////////////

///////////////////////////////////////////////
/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.PointerEventsPolyfill=b()}(this,function(){"use strict";function a(a,b){b=b||Object.create(null);var c=document.createEvent("Event");c.initEvent(a,b.bubbles||!1,b.cancelable||!1);
for(var d,e=2;e<m.length;e++)d=m[e],c[d]=b[d]||n[e];c.buttons=b.buttons||0;
var f=0;return f=b.pressure&&c.buttons?b.pressure:c.buttons?.5:0,c.x=c.clientX,c.y=c.clientY,c.pointerId=b.pointerId||0,c.width=b.width||0,c.height=b.height||0,c.pressure=f,c.tiltX=b.tiltX||0,c.tiltY=b.tiltY||0,c.twist=b.twist||0,c.tangentialPressure=b.tangentialPressure||0,c.pointerType=b.pointerType||"",c.hwTimestamp=b.hwTimestamp||0,c.isPrimary=b.isPrimary||!1,c}function b(){this.array=[],this.size=0}function c(a,b,c,d){this.addCallback=a.bind(d),this.removeCallback=b.bind(d),this.changedCallback=c.bind(d),A&&(this.observer=new A(this.mutationWatcher.bind(this)))}function d(a){return"body /shadow-deep/ "+e(a)}function e(a){return'[touch-action="'+a+'"]'}function f(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; }"}function g(){if(F){D.forEach(function(a){String(a)===a?(E+=e(a)+f(a)+"\n",G&&(E+=d(a)+f(a)+"\n")):(E+=a.selectors.map(e)+f(a.rule)+"\n",G&&(E+=a.selectors.map(d)+f(a.rule)+"\n"))});var a=document.createElement("style");a.textContent=E,document.head.appendChild(a)}}function h(){if(!window.PointerEvent){if(window.PointerEvent=a,window.navigator.msPointerEnabled){var b=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:b,enumerable:!0}),u.registerSource("ms",_)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),u.registerSource("mouse",N),void 0!==window.ontouchstart&&u.registerSource("touch",V);u.register(document)}}function i(a){if(!u.pointermap.has(a)){var b=new Error("InvalidPointerId");throw b.name="InvalidPointerId",b}}function j(a){for(var b=a.parentNode;b&&b!==a.ownerDocument;)b=b.parentNode;if(!b){var c=new Error("InvalidStateError");throw c.name="InvalidStateError",c}}function k(a){var b=u.pointermap.get(a);return 0!==b.buttons}function l(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:W},releasePointerCapture:{value:X},hasPointerCapture:{value:Y}})}
var m=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],n=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],o=window.Map&&window.Map.prototype.forEach,p=o?Map:b;b.prototype={set:function(a,b){return void 0===b?this["delete"](a):(this.has(a)||this.size++,void(this.array[a]=b))},has:function(a){return void 0!==this.array[a]},"delete":function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.array.length=0,this.size=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var q=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],r=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],s={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},t="undefined"!=typeof SVGElementInstance,u={pointermap:new p,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b,d=c.events;d&&(d.forEach(function(a){c[a]&&(this.eventMap[a]=c[a].bind(c))},this),this.eventSources[a]=c,this.eventSourceList.push(c))},register:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.register.call(b,a)},unregister:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.unregister.call(b,a)},contains:function(a,b){try{return a.contains(b)}catch(c){return!1}},down:function(a){a.bubbles=!0,this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0,this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0,this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=!1,this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1,this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0,this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0,this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0,this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a),this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a),this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type,c=this.eventMap&&this.eventMap[b];c&&c(a),a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(b,c){this.captureInfo[c.pointerId]&&(c.relatedTarget=null);var d=new a(b,c);return c.preventDefault&&(d.preventDefault=c.preventDefault),d._target=d._target||c.target,d},fireEvent:function(a,b){var c=this.makeEvent(a,b);return this.dispatchEvent(c)},cloneEvent:function(a){for(var b,c=Object.create(null),d=0;d<q.length;d++)b=q[d],c[b]=a[b]||r[d],!t||"target"!==b&&"relatedTarget"!==b||c[b]instanceof SVGElementInstance&&(c[b]=c[b].correspondingUseElement);return a.preventDefault&&(c.preventDefault=function(){a.preventDefault()}),c},getTarget:function(a){var b=this.captureInfo[a.pointerId];return b?a._target!==b&&a.type in s?void 0:b:a._target},propagate:function(a,b,c){for(var d=a.target,e=[];d!==document&&!d.contains(a.relatedTarget);) if(e.push(d),d=d.parentNode,!d)return;c&&e.reverse(),e.forEach(function(c){a.target=c,b.call(this,a)},this)},setCapture:function(b,c,d){this.captureInfo[b]&&this.releaseCapture(b,d),this.captureInfo[b]=c,this.implicitRelease=this.releaseCapture.bind(this,b,d),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var e=new a("gotpointercapture");e.pointerId=b,e._target=c,d||this.asyncDispatchEvent(e)},releaseCapture:function(b,c){var d=this.captureInfo[b];if(d){this.captureInfo[b]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var e=new a("lostpointercapture");e.pointerId=b,e._target=d,c||this.asyncDispatchEvent(e)}},dispatchEvent:/*scope.external.dispatchEvent || */function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};u.boundHandler=u.eventHandler.bind(u);var v={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&Boolean(a.elementFromPoint)},targetingShadow:function(a){var b=this.shadow(a);if(this.canTarget(b))return b},olderShadow:function(a){var b=a.olderShadowRoot;if(!b){var c=a.querySelector("shadow");c&&(b=c.olderShadowRoot)}return b},allShadows:function(a){for(var b=[],c=this.shadow(a);c;)b.push(c),c=this.olderShadow(c);return b},searchRoot:function(a,b,c){if(a){var d,e,f=a.elementFromPoint(b,c);for(e=this.targetingShadow(f);e;){if(d=e.elementFromPoint(b,c)){var g=this.targetingShadow(d);return this.searchRoot(g,b,c)||d} e=this.olderShadow(e)} return f}},owner:function(a){
for(var b=a;b.parentNode;)b=b.parentNode;
return b.nodeType!==Node.DOCUMENT_NODE&&b.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(b=document),b},findTarget:function(a){var b=a.clientX,c=a.clientY,d=this.owner(a.target);
return d.elementFromPoint(b,c)||(d=document),this.searchRoot(d,b,c)}},w=Array.prototype.forEach.call.bind(Array.prototype.forEach),x=Array.prototype.map.call.bind(Array.prototype.map),y=Array.prototype.slice.call.bind(Array.prototype.slice),z=Array.prototype.filter.call.bind(Array.prototype.filter),A=window.MutationObserver||window.WebKitMutationObserver,B="[touch-action]",C={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};c.prototype={watchSubtree:function(a){
//
this.observer&&v.canTarget(a)&&this.observer.observe(a,C)},enableOnSubtree:function(a){this.watchSubtree(a),a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},installNewSubtree:function(a){w(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll(B):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(y(b))},
installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){
var b=x(a,this.findElements,this);
return b.push(z(a,this.isElement)),b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){if("childList"===a.type){var b=this.flattenMutationTree(a.addedNodes);b.forEach(this.addElement,this);var c=this.flattenMutationTree(a.removedNodes);c.forEach(this.removeElement,this)}else"attributes"===a.type&&this.elementChanged(a.target,a.oldValue)}};var D=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],E="",F=window.PointerEvent||window.MSPointerEvent,G=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,H=u.pointermap,I=25,J=[1,4,2,8,16],K=!1;try{K=1===new MouseEvent("test",{buttons:1}).buttons}catch(L){}
var M,N={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},lastTouches:[],
isEventSimulatedFromTouch:function(a){for(var b,c=this.lastTouches,d=a.clientX,e=a.clientY,f=0,g=c.length;f<g&&(b=c[f]);f++){
var h=Math.abs(d-b.x),i=Math.abs(e-b.y);if(h<=I&&i<=I)return!0}},prepareEvent:function(a){var b=u.cloneEvent(a),c=b.preventDefault;return b.preventDefault=function(){a.preventDefault(),c()},b.pointerId=this.POINTER_ID,b.isPrimary=!0,b.pointerType=this.POINTER_TYPE,b},prepareButtonsForMove:function(a,b){var c=H.get(this.POINTER_ID);
0!==b.which&&c?a.buttons=c.buttons:a.buttons=0,b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);K||(c.buttons=J[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons),H.set(this.POINTER_ID,a),b&&0!==b.buttons?u.move(c):u.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);if(!K){var d=J[c.button];
c.buttons=b?b.buttons&~d:0,a.buttons=c.buttons}H.set(this.POINTER_ID,a),
c.buttons&=~J[c.button],0===c.buttons?u.up(c):u.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,u.leaveOut(b)}},cancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.deactivateMouse()},deactivateMouse:function(){H["delete"](this.POINTER_ID)}},O=u.captureInfo,P=v.findTarget.bind(v),Q=v.allShadows.bind(v),R=u.pointermap,S=2500,T=200,U="touch-action",V={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){M.enableOnSubtree(a)},unregister:function(){},elementAdded:function(a){var b=a.getAttribute(U),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,u.listen(a,this.events),
Q(a).forEach(function(a){a._scrollType=c,u.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0,u.unlisten(a,this.events),
Q(a).forEach(function(a){a._scrollType=void 0,u.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute(U),d=this.touchActionToScrollType(c),e=this.touchActionToScrollType(b);
d&&e?(a._scrollType=d,Q(a).forEach(function(a){a._scrollType=d},this)):e?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=a,c=this.scrollTypes;return"none"===b?"none":b===c.XSCROLLER?"X":b===c.YSCROLLER?"Y":c.SCROLLER.exec(b)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){
(0===R.size||1===R.size&&R.has(1))&&(this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(a){a.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(a,T)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;return"touchstart"!==a&&"touchmove"!==a||(b=1),b},touchToPointer:function(a){var b=this.currentTouchEvent,c=u.cloneEvent(a),d=c.pointerId=a.identifier+2;c.target=O[d]||P(c),c.bubbles=!0,c.cancelable=!0,c.detail=this.clickCount,c.button=0,c.buttons=this.typeToButtons(b.type),c.width=2*(a.radiusX||a.webkitRadiusX||0),c.height=2*(a.radiusY||a.webkitRadiusY||0),c.pressure=a.force||a.webkitForce||.5,c.isPrimary=this.isPrimaryTouch(a),c.pointerType=this.POINTER_TYPE,
c.altKey=b.altKey,c.ctrlKey=b.ctrlKey,c.metaKey=b.metaKey,c.shiftKey=b.shiftKey;
var e=this;return c.preventDefault=function(){e.scrolling=!1,e.firstXY=null,b.preventDefault()},c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;for(var d,e=0;e<c.length;e++)d=c[e],b.call(this,this.touchToPointer(d))},
shouldScroll:function(a){if(this.firstXY){var b,c=a.currentTarget._scrollType;if("none"===c)
b=!1;else if("XY"===c)
b=!0;else{var d=a.changedTouches[0],e=c,f="Y"===c?"X":"Y",g=Math.abs(d["client"+e]-this.firstXY[e]),h=Math.abs(d["client"+f]-this.firstXY[f]);
b=g>=h}return this.firstXY=null,b}},findTouch:function(a,b){for(var c,d=0,e=a.length;d<e&&(c=a[d]);d++)if(c.identifier===b)return!0},
vacuumTouches:function(a){var b=a.touches;
if(R.size>=b.length){var c=[];R.forEach(function(a,d){
if(1!==d&&!this.findTouch(b,d-2)){var e=a.out;c.push(e)}},this),c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a),this.setPrimaryTouch(a.changedTouches[0]),this.dedupSynthMouse(a),this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){R.set(a.pointerId,{target:a.target,out:a,outTarget:a.target}),u.enterOver(a),u.down(a)},touchmove:function(a){this.scrolling||(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=a,c=R.get(b.pointerId);
if(c){var d=c.out,e=c.outTarget;u.move(b),d&&e!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=e,
d.target=e,b.target?(u.leaveOut(d),u.enterOver(b)):(
b.target=e,b.relatedTarget=null,this.cancelOut(b))),c.out=b,c.outTarget=b.target}},touchend:function(a){this.dedupSynthMouse(a),this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||(u.up(a),u.leaveOut(a)),this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){u.cancel(a),u.leaveOut(a),this.cleanUpPointer(a)},cleanUpPointer:function(a){R["delete"](a.pointerId),this.removePrimaryPointer(a)},
dedupSynthMouse:function(a){var b=N.lastTouches,c=a.changedTouches[0];
if(this.isPrimaryTouch(c)){
var d={x:c.clientX,y:c.clientY};b.push(d);var e=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)}.bind(null,b,d);setTimeout(e,S)}}};M=new c(V.elementAdded,V.elementRemoved,V.elementChanged,V);var W,X,Y,Z=u.pointermap,$=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,_={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;return $&&(b=u.cloneEvent(a),b.pointerType=this.POINTER_TYPES[a.pointerType]),b},cleanup:function(a){Z["delete"](a)},MSPointerDown:function(a){Z.set(a.pointerId,a);var b=this.prepareEvent(a);u.down(b)},MSPointerMove:function(a){var b=this.prepareEvent(a);u.move(b)},MSPointerUp:function(a){var b=this.prepareEvent(a);u.up(b),this.cleanup(a.pointerId)},MSPointerOut:function(a){var b=this.prepareEvent(a);u.leaveOut(b)},MSPointerOver:function(a){var b=this.prepareEvent(a);u.enterOver(b)},MSPointerCancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){var b=u.makeEvent("lostpointercapture",a);u.dispatchEvent(b)},MSGotPointerCapture:function(a){var b=u.makeEvent("gotpointercapture",a);u.dispatchEvent(b)}},aa=window.navigator;aa.msPointerEnabled?(W=function(a){i(a),j(this),k(a)&&(u.setCapture(a,this,!0),this.msSetPointerCapture(a))},X=function(a){i(a),u.releaseCapture(a,!0),this.msReleasePointerCapture(a)}):(W=function(a){i(a),j(this),k(a)&&u.setCapture(a,this)},X=function(a){i(a),u.releaseCapture(a)}),Y=function(a){return!!u.captureInfo[a]},g(),h(),l();var ba={dispatcher:u,Installer:c,PointerEvent:a,PointerMap:p,targetFinding:v};return ba});

///////////////////////////////////////////////

///////////////////////////////////////////////
var config = {"dark_mode": true, "show_pads": true, "show_fabrication": false, "show_silkscreen": true, "highlight_pin1": "none", "redraw_on_drag": true, "board_rotation": 0, "checkboxes": "Sourced,Placed", "bom_view": "left-right", "layer_view": "FB", "offset_back_rotation": false, "kicad_text_formatting": true, "fields": ["Value", "Footprint", "Datasheet", "Description", "MANUFACTURER", "Mouser No", "Package", "Price"]}
///////////////////////////////////////////////

///////////////////////////////////////////////
var pcbdata = JSON.parse(LZString.decompressFromBase64("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"))
///////////////////////////////////////////////

///////////////////////////////////////////////
/* Utility functions */

var storagePrefix = 'KiCad_HTML_BOM__' + pcbdata.metadata.title + '__' +
  pcbdata.metadata.revision + '__#';
var storage;

function initStorage(key) {
  try {
    window.localStorage.getItem("blank");
    storage = window.localStorage;
  } catch (e) {
    // localStorage not available
  }
  if (!storage) {
    try {
      window.sessionStorage.getItem("blank");
      storage = window.sessionStorage;
    } catch (e) {
      // sessionStorage also not available
    }
  }
}

function readStorage(key) {
  if (storage) {
    return storage.getItem(storagePrefix + key);
  } else {
    return null;
  }
}

function writeStorage(key, value) {
  if (storage) {
    storage.setItem(storagePrefix + key, value);
  }
}

function fancyDblClickHandler(el, onsingle, ondouble) {
  return function () {
    if (el.getAttribute("data-dblclick") == null) {
      el.setAttribute("data-dblclick", 1);
      setTimeout(function () {
        if (el.getAttribute("data-dblclick") == 1) {
          onsingle();
        }
        el.removeAttribute("data-dblclick");
      }, 200);
    } else {
      el.removeAttribute("data-dblclick");
      ondouble();
    }
  }
}

function smoothScrollToRow(rowid) {
  document.getElementById(rowid).scrollIntoView({
    behavior: "smooth",
    block: "center",
    inline: "nearest"
  });
}

function focusInputField(input) {
  input.scrollIntoView(false);
  input.focus();
  input.select();
}

function saveBomTable(output) {
  var text = '';
  for (var node of bomhead.childNodes[0].childNodes) {
    if (node.firstChild) {
      text += (output == 'csv' ? `"${node.firstChild.nodeValue}"` : node.firstChild.nodeValue);
    }
    if (node != bomhead.childNodes[0].lastChild) {
      text += (output == 'csv' ? ',' : '\t');
    }
  }
  text += '\n';
  for (var row of bombody.childNodes) {
    for (var cell of row.childNodes) {
      let val = '';
      for (var node of cell.childNodes) {
        if (node.nodeName == "INPUT") {
          if (node.checked) {
            val += '';
          }
        } else if ((node.nodeName == "MARK") || (node.nodeName == "A")) {
          val += node.firstChild.nodeValue;
        } else {
          val += node.nodeValue;
        }
      }
      if (output == 'csv') {
        val = val.replace(/\"/g, '\"\"'); // pair of double-quote characters
        if (isNumeric(val)) {
          val = +val;                     // use number
        } else {
          val = `"${val}"`;               // enclosed within double-quote
        }
      }
      text += val;
      if (cell != row.lastChild) {
        text += (output == 'csv' ? ',' : '\t');
      }
    }
    text += '\n';
  }

  if (output != 'clipboard') {
    // To file: csv or txt
    var blob = new Blob([text], {
      type: `text/${output}`
    });
    saveFile(`${pcbdata.metadata.title}.${output}`, blob);
  } else {
    // To clipboard
    var textArea = document.createElement("textarea");
    textArea.classList.add('clipboard-temp');
    textArea.value = text;

    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();

    try {
      if (document.execCommand('copy')) {
        console.log('Bom copied to clipboard.');
      }
    } catch (err) {
      console.log('Can not copy to clipboard.');
    }

    document.body.removeChild(textArea);
  }
}

function isNumeric(str) {
  /* https://stackoverflow.com/a/175787 */
  return (typeof str != "string" ? false : !isNaN(str) && !isNaN(parseFloat(str)));
}

function removeGutterNode(node) {
  for (var i = 0; i < node.childNodes.length; i++) {
    if (node.childNodes[i].classList &&
      node.childNodes[i].classList.contains("gutter")) {
      node.removeChild(node.childNodes[i]);
      break;
    }
  }
}

function cleanGutters() {
  removeGutterNode(document.getElementById("bot"));
  removeGutterNode(document.getElementById("canvasdiv"));
}

var units = {
  prefixes: {
    giga: ["G", "g", "giga", "Giga", "GIGA"],
    mega: ["M", "mega", "Mega", "MEGA"],
    kilo: ["K", "k", "kilo", "Kilo", "KILO"],
    milli: ["m", "milli", "Milli", "MILLI"],
    micro: ["U", "u", "micro", "Micro", "MICRO", "", ""], // different utf8 
    nano: ["N", "n", "nano", "Nano", "NANO"],
    pico: ["P", "p", "pico", "Pico", "PICO"],
  },
  unitsShort: ["R", "r", "", "F", "f", "H", "h"],
  unitsLong: [
    "OHM", "Ohm", "ohm", "ohms",
    "FARAD", "Farad", "farad",
    "HENRY", "Henry", "henry"
  ],
  getMultiplier: function (s) {
    if (this.prefixes.giga.includes(s)) return 1e9;
    if (this.prefixes.mega.includes(s)) return 1e6;
    if (this.prefixes.kilo.includes(s)) return 1e3;
    if (this.prefixes.milli.includes(s)) return 1e-3;
    if (this.prefixes.micro.includes(s)) return 1e-6;
    if (this.prefixes.nano.includes(s)) return 1e-9;
    if (this.prefixes.pico.includes(s)) return 1e-12;
    return 1;
  },
  valueRegex: null,
}

function initUtils() {
  var allPrefixes = units.prefixes.giga
    .concat(units.prefixes.mega)
    .concat(units.prefixes.kilo)
    .concat(units.prefixes.milli)
    .concat(units.prefixes.micro)
    .concat(units.prefixes.nano)
    .concat(units.prefixes.pico);
  var allUnits = units.unitsShort.concat(units.unitsLong);
  units.valueRegex = new RegExp("^([0-9\.]+)" +
    "\\s*(" + allPrefixes.join("|") + ")?" +
    "(" + allUnits.join("|") + ")?" +
    "(\\b.*)?$", "");
  units.valueAltRegex = new RegExp("^([0-9]*)" +
    "(" + units.unitsShort.join("|") + ")?" +
    "([GgMmKkUuNnPp])?" +
    "([0-9]*)" +
    "(\\b.*)?$", "");
  if (config.fields.includes("Value")) {
    var index = config.fields.indexOf("Value");
    pcbdata.bom["parsedValues"] = {};
    for (var id in pcbdata.bom.fields) {
      pcbdata.bom.parsedValues[id] = parseValue(pcbdata.bom.fields[id][index])
    }
  }
}

function parseValue(val, ref) {
  var inferUnit = (unit, ref) => {
    if (unit) {
      unit = unit.toLowerCase();
      if (unit == '' || unit == "ohm" || unit == "ohms") {
        unit = 'r';
      }
      unit = unit[0];
    } else {
      ref = /^([a-z]+)\d+$/i.exec(ref);
      if (ref) {
        ref = ref[1].toLowerCase();
        if (ref == "c") unit = 'f';
        else if (ref == "l") unit = 'h';
        else if (ref == "r" || ref == "rv") unit = 'r';
        else unit = null;
      }
    }
    return unit;
  };
  val = val.replace(/,/g, "");
  var match = units.valueRegex.exec(val);
  var unit;
  if (match) {
    val = parseFloat(match[1]);
    if (match[2]) {
      val = val * units.getMultiplier(match[2]);
    }
    unit = inferUnit(match[3], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[4],
    }
  }
  match = units.valueAltRegex.exec(val);
  if (match && (match[1] || match[4])) {
    val = parseFloat(match[1] + "." + match[4]);
    if (match[3]) {
      val = val * units.getMultiplier(match[3]);
    }
    unit = inferUnit(match[2], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[5],
    }
  }
  return null;
}

function valueCompare(a, b, stra, strb) {
  if (a === null && b === null) {
    // Failed to parse both values, compare them as strings.
    if (stra != strb) return stra > strb ? 1 : -1;
    else return 0;
  } else if (a === null) {
    return 1;
  } else if (b === null) {
    return -1;
  } else {
    if (a.unit != b.unit) return a.unit > b.unit ? 1 : -1;
    else if (a.val != b.val) return a.val > b.val ? 1 : -1;
    else if (a.extra != b.extra) return a.extra > b.extra ? 1 : -1;
    else return 0;
  }
}

function validateSaveImgDimension(element) {
  var valid = false;
  var intValue = 0;
  if (/^[1-9]\d*$/.test(element.value)) {
    intValue = parseInt(element.value);
    if (intValue <= 16000) {
      valid = true;
    }
  }
  if (valid) {
    element.classList.remove("invalid");
  } else {
    element.classList.add("invalid");
  }
  return intValue;
}

function saveImage(layer) {
  var width = validateSaveImgDimension(document.getElementById("render-save-width"));
  var height = validateSaveImgDimension(document.getElementById("render-save-height"));
  var bgcolor = null;
  if (!document.getElementById("render-save-transparent").checked) {
    var style = getComputedStyle(topmostdiv);
    bgcolor = style.getPropertyValue("background-color");
  }
  if (!width || !height) return;

  // Prepare image
  var canvas = document.createElement("canvas");
  var layerdict = {
    transform: {
      x: 0,
      y: 0,
      s: 1,
      panx: 0,
      pany: 0,
      zoom: 1,
    },
    bg: canvas,
    fab: canvas,
    silk: canvas,
    highlight: canvas,
    layer: layer,
  }
  // Do the rendering
  recalcLayerScale(layerdict, width, height);
  prepareLayer(layerdict);
  clearCanvas(canvas, bgcolor);
  drawBackground(layerdict, false);
  drawHighlightsOnLayer(layerdict, false);

  // Save image
  var imgdata = canvas.toDataURL("image/png");

  var filename = pcbdata.metadata.title;
  if (pcbdata.metadata.revision) {
    filename += `.${pcbdata.metadata.revision}`;
  }
  filename += `.${layer}.png`;
  saveFile(filename, dataURLtoBlob(imgdata));
}

function saveSettings() {
  var data = {
    type: "InteractiveHtmlBom settings",
    version: 1,
    pcbmetadata: pcbdata.metadata,
    settings: settings,
  }
  var blob = new Blob([JSON.stringify(data, null, 4)], {
    type: "application/json"
  });
  saveFile(`${pcbdata.metadata.title}.settings.json`, blob);
}

function loadSettings() {
  var input = document.createElement("input");
  input.type = "file";
  input.accept = ".settings.json";
  input.onchange = function (e) {
    var file = e.target.files[0];
    var reader = new FileReader();
    reader.onload = readerEvent => {
      var content = readerEvent.target.result;
      var newSettings;
      try {
        newSettings = JSON.parse(content);
      } catch (e) {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      if (newSettings.type != "InteractiveHtmlBom settings") {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      var metadataMatches = newSettings.hasOwnProperty("pcbmetadata");
      if (metadataMatches) {
        for (var k in pcbdata.metadata) {
          if (!newSettings.pcbmetadata.hasOwnProperty(k) || newSettings.pcbmetadata[k] != pcbdata.metadata[k]) {
            metadataMatches = false;
          }
        }
      }
      if (!metadataMatches) {
        var currentMetadata = JSON.stringify(pcbdata.metadata, null, 4);
        var fileMetadata = JSON.stringify(newSettings.pcbmetadata, null, 4);
        if (!confirm(
          `Settins file metadata does not match current metadata.\n\n` +
          `Page metadata:\n${currentMetadata}\n\n` +
          `Settings file metadata:\n${fileMetadata}\n\n` +
          `Press OK if you would like to import settings anyway.`)) {
          return;
        }
      }
      overwriteSettings(newSettings.settings);
    }
    reader.readAsText(file, 'UTF-8');
  }
  input.click();
}

function resetSettings() {
  if (!confirm(
    `This will reset all checkbox states and other settings.\n\n` +
    `Press OK if you want to continue.`)) {
    return;
  }
  if (storage) {
    var keys = [];
    for (var i = 0; i < storage.length; i++) {
      var key = storage.key(i);
      if (key.startsWith(storagePrefix)) keys.push(key);
    }
    for (var key of keys) storage.removeItem(key);
  }
  location.reload();
}

function overwriteSettings(newSettings) {
  initDone = false;
  Object.assign(settings, newSettings);
  writeStorage("bomlayout", settings.bomlayout);
  writeStorage("bommode", settings.bommode);
  writeStorage("canvaslayout", settings.canvaslayout);
  writeStorage("bomCheckboxes", settings.checkboxes.join(","));
  document.getElementById("bomCheckboxes").value = settings.checkboxes.join(",");
  for (var checkbox of settings.checkboxes) {
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
  }
  writeStorage("markWhenChecked", settings.markWhenChecked);
  padsVisible(settings.renderPads);
  document.getElementById("padsCheckbox").checked = settings.renderPads;
  fabricationVisible(settings.renderFabrication);
  document.getElementById("fabricationCheckbox").checked = settings.renderFabrication;
  silkscreenVisible(settings.renderSilkscreen);
  document.getElementById("silkscreenCheckbox").checked = settings.renderSilkscreen;
  referencesVisible(settings.renderReferences);
  document.getElementById("referencesCheckbox").checked = settings.renderReferences;
  valuesVisible(settings.renderValues);
  document.getElementById("valuesCheckbox").checked = settings.renderValues;
  tracksVisible(settings.renderTracks);
  document.getElementById("tracksCheckbox").checked = settings.renderTracks;
  zonesVisible(settings.renderZones);
  document.getElementById("zonesCheckbox").checked = settings.renderZones;
  dnpOutline(settings.renderDnpOutline);
  document.getElementById("dnpOutlineCheckbox").checked = settings.renderDnpOutline;
  setRedrawOnDrag(settings.redrawOnDrag);
  document.getElementById("dragCheckbox").checked = settings.redrawOnDrag;
  setDarkMode(settings.darkMode);
  document.getElementById("darkmodeCheckbox").checked = settings.darkMode;
  setHighlightPin1(settings.highlightpin1);
  document.forms.highlightpin1.highlightpin1.value = settings.highlightpin1;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  setOffsetBackRotation(settings.offsetBackRotation);
  document.getElementById("offsetBackRotationCheckbox").checked = settings.offsetBackRotation;
  initDone = true;
  prepCheckboxes();
  changeBomLayout(settings.bomlayout);
}

function saveFile(filename, blob) {
  var link = document.createElement("a");
  var objurl = URL.createObjectURL(blob);
  link.download = filename;
  link.href = objurl;
  link.click();
}

function dataURLtoBlob(dataurl) {
  var arr = dataurl.split(','),
    mime = arr[0].match(/:(.*?);/)[1],
    bstr = atob(arr[1]),
    n = bstr.length,
    u8arr = new Uint8Array(n);
  while (n--) {
    u8arr[n] = bstr.charCodeAt(n);
  }
  return new Blob([u8arr], {
    type: mime
  });
}

var settings = {
  canvaslayout: "FB",
  bomlayout: "left-right",
  bommode: "grouped",
  checkboxes: [],
  checkboxStoredRefs: {},
  darkMode: false,
  highlightpin1: "none",
  redrawOnDrag: true,
  boardRotation: 0,
  offsetBackRotation: false,
  renderPads: true,
  renderReferences: true,
  renderValues: true,
  renderSilkscreen: true,
  renderFabrication: true,
  renderDnpOutline: false,
  renderTracks: true,
  renderZones: true,
  columnOrder: [],
  hiddenColumns: [],
  netColors: {},
}

function initDefaults() {
  settings.bomlayout = readStorage("bomlayout");
  if (settings.bomlayout === null) {
    settings.bomlayout = config.bom_view;
  }
  if (!['bom-only', 'left-right', 'top-bottom'].includes(settings.bomlayout)) {
    settings.bomlayout = config.bom_view;
  }
  settings.bommode = readStorage("bommode");
  if (settings.bommode === null) {
    settings.bommode = "grouped";
  }
  if (settings.bommode == "netlist" && !pcbdata.nets) {
    settings.bommode = "grouped";
  }
  if (!["grouped", "ungrouped", "netlist"].includes(settings.bommode)) {
    settings.bommode = "grouped";
  }
  settings.canvaslayout = readStorage("canvaslayout");
  if (settings.canvaslayout === null) {
    settings.canvaslayout = config.layer_view;
  }
  var bomCheckboxes = readStorage("bomCheckboxes");
  if (bomCheckboxes === null) {
    bomCheckboxes = config.checkboxes;
  }
  settings.checkboxes = bomCheckboxes.split(",").filter((e) => e);
  document.getElementById("bomCheckboxes").value = bomCheckboxes;

  var highlightpin1 = readStorage("highlightpin1") || config.highlight_pin1;
  if (highlightpin1 === "false") highlightpin1 = "none";
  if (highlightpin1 === "true") highlightpin1 = "all";
  setHighlightPin1(highlightpin1);
  document.forms.highlightpin1.highlightpin1.value = highlightpin1;

  settings.markWhenChecked = readStorage("markWhenChecked") || "";
  populateMarkWhenCheckedOptions();

  function initBooleanSetting(storageString, def, elementId, func) {
    var b = readStorage(storageString);
    if (b === null) {
      b = def;
    } else {
      b = (b == "true");
    }
    document.getElementById(elementId).checked = b;
    func(b);
  }

  initBooleanSetting("padsVisible", config.show_pads, "padsCheckbox", padsVisible);
  initBooleanSetting("fabricationVisible", config.show_fabrication, "fabricationCheckbox", fabricationVisible);
  initBooleanSetting("silkscreenVisible", config.show_silkscreen, "silkscreenCheckbox", silkscreenVisible);
  initBooleanSetting("referencesVisible", true, "referencesCheckbox", referencesVisible);
  initBooleanSetting("valuesVisible", true, "valuesCheckbox", valuesVisible);
  if ("tracks" in pcbdata) {
    initBooleanSetting("tracksVisible", true, "tracksCheckbox", tracksVisible);
    initBooleanSetting("zonesVisible", true, "zonesCheckbox", zonesVisible);
  } else {
    document.getElementById("tracksAndZonesCheckboxes").style.display = "none";
    tracksVisible(false);
    zonesVisible(false);
  }
  initBooleanSetting("dnpOutline", false, "dnpOutlineCheckbox", dnpOutline);
  initBooleanSetting("redrawOnDrag", config.redraw_on_drag, "dragCheckbox", setRedrawOnDrag);
  initBooleanSetting("darkmode", config.dark_mode, "darkmodeCheckbox", setDarkMode);

  var fields = ["checkboxes", "References"].concat(config.fields).concat(["Quantity"]);
  var hcols = JSON.parse(readStorage("hiddenColumns"));
  if (hcols === null) {
    hcols = [];
  }
  settings.hiddenColumns = hcols.filter(e => fields.includes(e));

  var cord = JSON.parse(readStorage("columnOrder"));
  if (cord === null) {
    cord = fields;
  } else {
    cord = cord.filter(e => fields.includes(e));
    if (cord.length != fields.length)
      cord = fields;
  }
  settings.columnOrder = cord;

  settings.boardRotation = readStorage("boardRotation");
  if (settings.boardRotation === null) {
    settings.boardRotation = config.board_rotation * 5;
  } else {
    settings.boardRotation = parseInt(settings.boardRotation);
  }
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  initBooleanSetting("offsetBackRotation", config.offset_back_rotation, "offsetBackRotationCheckbox", setOffsetBackRotation);

  settings.netColors = JSON.parse(readStorage("netColors")) || {};
}

// Helper classes for user js callbacks.

const IBOM_EVENT_TYPES = {
  ALL: "all",
  HIGHLIGHT_EVENT: "highlightEvent",
  CHECKBOX_CHANGE_EVENT: "checkboxChangeEvent",
  BOM_BODY_CHANGE_EVENT: "bomBodyChangeEvent",
}

const EventHandler = {
  callbacks: {},
  init: function () {
    for (eventType of Object.values(IBOM_EVENT_TYPES))
      this.callbacks[eventType] = [];
  },
  registerCallback: function (eventType, callback) {
    this.callbacks[eventType].push(callback);
  },
  emitEvent: function (eventType, eventArgs) {
    event = {
      eventType: eventType,
      args: eventArgs,
    }
    var callback;
    for (callback of this.callbacks[eventType])
      callback(event);
    for (callback of this.callbacks[IBOM_EVENT_TYPES.ALL])
      callback(event);
  }
}
EventHandler.init();

///////////////////////////////////////////////

///////////////////////////////////////////////
/* PCB rendering code */

var emptyContext2d = document.createElement("canvas").getContext("2d");

function deg2rad(deg) {
  return deg * Math.PI / 180;
}

function calcFontPoint(linepoint, text, offsetx, offsety, tilt) {
  var point = [
    linepoint[0] * text.width + offsetx,
    linepoint[1] * text.height + offsety
  ];
  // This approximates pcbnew behavior with how text tilts depending on horizontal justification
  point[0] -= (linepoint[1] + 0.5 * (1 + text.justify[0])) * text.height * tilt;
  return point;
}

function drawText(ctx, text, color) {
  if ("ref" in text && !settings.renderReferences) return;
  if ("val" in text && !settings.renderValues) return;
  ctx.save();
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.lineWidth = text.thickness;
  if ("svgpath" in text) {
    ctx.stroke(new Path2D(text.svgpath));
    ctx.restore();
    return;
  }
  if ("polygons" in text) {
    ctx.fill(getPolygonsPath(text));
    ctx.restore();
    return;
  }
  ctx.translate(...text.pos);
  ctx.translate(text.thickness * 0.5, 0);
  var angle = -text.angle;
  if (text.attr.includes("mirrored")) {
    ctx.scale(-1, 1);
    angle = -angle;
  }
  var tilt = 0;
  if (text.attr.includes("italic")) {
    tilt = 0.125;
  }
  var interline = text.height * 1.5 + text.thickness;
  var txt = text.text.split("\n");
  // KiCad ignores last empty line.
  if (txt[txt.length - 1] == '') txt.pop();
  ctx.rotate(deg2rad(angle));
  var offsety = (1 - text.justify[1]) / 2 * text.height; // One line offset
  offsety -= (txt.length - 1) * (text.justify[1] + 1) / 2 * interline; // Multiline offset
  for (var i in txt) {
    var lineWidth = text.thickness + interline / 2 * tilt;
    for (var j = 0; j < txt[i].length; j++) {
      if (txt[i][j] == '\t') {
        var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
        lineWidth += fourSpaces - lineWidth % fourSpaces;
      } else {
        if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
        }
        lineWidth += pcbdata.font_data[txt[i][j]].w * text.width;
      }
    }
    var offsetx = -lineWidth * (text.justify[0] + 1) / 2;
    var inOverbar = false;
    for (var j = 0; j < txt[i].length; j++) {
      if (config.kicad_text_formatting) {
        if (txt[i][j] == '\t') {
          var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
          offsetx += fourSpaces - offsetx % fourSpaces;
          continue;
        } else if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
          if (txt[i][j] != '~') {
            inOverbar = !inOverbar;
          }
        }
      }
      var glyph = pcbdata.font_data[txt[i][j]];
      if (inOverbar) {
        var overbarStart = [offsetx, -text.height * 1.4 + offsety];
        var overbarEnd = [offsetx + text.width * glyph.w, overbarStart[1]];

        if (!lastHadOverbar) {
          overbarStart[0] += text.height * 1.4 * tilt;
          lastHadOverbar = true;
        }
        ctx.beginPath();
        ctx.moveTo(...overbarStart);
        ctx.lineTo(...overbarEnd);
        ctx.stroke();
      } else {
        lastHadOverbar = false;
      }
      for (var line of glyph.l) {
        ctx.beginPath();
        ctx.moveTo(...calcFontPoint(line[0], text, offsetx, offsety, tilt));
        for (var k = 1; k < line.length; k++) {
          ctx.lineTo(...calcFontPoint(line[k], text, offsetx, offsety, tilt));
        }
        ctx.stroke();
      }
      offsetx += glyph.w * text.width;
    }
    offsety += interline;
  }
  ctx.restore();
}

function drawedge(ctx, scalefactor, edge, color) {
  ctx.strokeStyle = color;
  ctx.fillStyle = color;
  ctx.lineWidth = Math.max(1 / scalefactor, edge.width);
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  if ("svgpath" in edge) {
    ctx.stroke(new Path2D(edge.svgpath));
  } else {
    ctx.beginPath();
    if (edge.type == "segment") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(...edge.end);
    }
    if (edge.type == "rect") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(edge.start[0], edge.end[1]);
      ctx.lineTo(...edge.end);
      ctx.lineTo(edge.end[0], edge.start[1]);
      ctx.lineTo(...edge.start);
    }
    if (edge.type == "arc") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        deg2rad(edge.startangle),
        deg2rad(edge.endangle));
    }
    if (edge.type == "circle") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        0, 2 * Math.PI);
      ctx.closePath();
    }
    if (edge.type == "curve") {
      ctx.moveTo(...edge.start);
      ctx.bezierCurveTo(...edge.cpa, ...edge.cpb, ...edge.end);
    }
    if("filled" in edge && edge.filled)
      ctx.fill();
    else
      ctx.stroke();
  }
}

function getChamferedRectPath(size, radius, chamfpos, chamfratio) {
  // chamfpos is a bitmask, left = 1, right = 2, bottom left = 4, bottom right = 8
  var path = new Path2D();
  var width = size[0];
  var height = size[1];
  var x = width * -0.5;
  var y = height * -0.5;
  var chamfOffset = Math.min(width, height) * chamfratio;
  path.moveTo(x, 0);
  if (chamfpos & 4) {
    path.lineTo(x, y + height - chamfOffset);
    path.lineTo(x + chamfOffset, y + height);
    path.lineTo(0, y + height);
  } else {
    path.arcTo(x, y + height, x + width, y + height, radius);
  }
  if (chamfpos & 8) {
    path.lineTo(x + width - chamfOffset, y + height);
    path.lineTo(x + width, y + height - chamfOffset);
    path.lineTo(x + width, 0);
  } else {
    path.arcTo(x + width, y + height, x + width, y, radius);
  }
  if (chamfpos & 2) {
    path.lineTo(x + width, y + chamfOffset);
    path.lineTo(x + width - chamfOffset, y);
    path.lineTo(0, y);
  } else {
    path.arcTo(x + width, y, x, y, radius);
  }
  if (chamfpos & 1) {
    path.lineTo(x + chamfOffset, y);
    path.lineTo(x, y + chamfOffset);
    path.lineTo(x, 0);
  } else {
    path.arcTo(x, y, x, y + height, radius);
  }
  path.closePath();
  return path;
}

function getOblongPath(size) {
  return getChamferedRectPath(size, Math.min(size[0], size[1]) / 2, 0, 0);
}

function getPolygonsPath(shape) {
  if (shape.path2d) {
    return shape.path2d;
  }
  if ("svgpath" in shape) {
    shape.path2d = new Path2D(shape.svgpath);
  } else {
    var path = new Path2D();
    for (var polygon of shape.polygons) {
      path.moveTo(...polygon[0]);
      for (var i = 1; i < polygon.length; i++) {
        path.lineTo(...polygon[i]);
      }
      path.closePath();
    }
    shape.path2d = path;
  }
  return shape.path2d;
}

function drawPolygonShape(ctx, scalefactor, shape, color) {
  ctx.save();
  if (!("svgpath" in shape)) {
    ctx.translate(...shape.pos);
    ctx.rotate(deg2rad(-shape.angle));
  }
  if("filled" in shape && !shape.filled) {
    ctx.strokeStyle = color;
    ctx.lineWidth = Math.max(1 / scalefactor, shape.width);
    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.stroke(getPolygonsPath(shape));
  } else {
    ctx.fillStyle = color;
    ctx.fill(getPolygonsPath(shape));
  }
  ctx.restore();
}

function drawDrawing(ctx, scalefactor, drawing, color) {
  if (["segment", "arc", "circle", "curve", "rect"].includes(drawing.type)) {
    drawedge(ctx, scalefactor, drawing, color);
  } else if (drawing.type == "polygon") {
    drawPolygonShape(ctx, scalefactor, drawing, color);
  } else {
    drawText(ctx, drawing, color);
  }
}

function getCirclePath(radius) {
  var path = new Path2D();
  path.arc(0, 0, radius, 0, 2 * Math.PI);
  path.closePath();
  return path;
}

function getCachedPadPath(pad) {
  if (!pad.path2d) {
    // if path2d is not set, build one and cache it on pad object
    if (pad.shape == "rect") {
      pad.path2d = new Path2D();
      pad.path2d.rect(...pad.size.map(c => -c * 0.5), ...pad.size);
    } else if (pad.shape == "oval") {
      pad.path2d = getOblongPath(pad.size);
    } else if (pad.shape == "circle") {
      pad.path2d = getCirclePath(pad.size[0] / 2);
    } else if (pad.shape == "roundrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, 0, 0);
    } else if (pad.shape == "chamfrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, pad.chamfpos, pad.chamfratio)
    } else if (pad.shape == "custom") {
      pad.path2d = getPolygonsPath(pad);
    }
  }
  return pad.path2d;
}

function drawPad(ctx, pad, color, outline) {
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(-deg2rad(pad.angle));
  if (pad.offset) {
    ctx.translate(...pad.offset);
  }
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  var path = getCachedPadPath(pad);
  if (outline) {
    ctx.stroke(path);
  } else {
    ctx.fill(path);
  }
  ctx.restore();
}

function drawPadHole(ctx, pad, padHoleColor) {
  if (pad.type != "th") return;
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(-deg2rad(pad.angle));
  ctx.fillStyle = padHoleColor;
  if (pad.drillshape == "oblong") {
    ctx.fill(getOblongPath(pad.drillsize));
  } else {
    ctx.fill(getCirclePath(pad.drillsize[0] / 2));
  }
  ctx.restore();
}

function drawFootprint(ctx, layer, scalefactor, footprint, colors, highlight, outline) {
  if (highlight) {
    // draw bounding box
    if (footprint.layer == layer) {
      ctx.save();
      ctx.globalAlpha = 0.2;
      ctx.translate(...footprint.bbox.pos);
      ctx.rotate(deg2rad(-footprint.bbox.angle));
      ctx.translate(...footprint.bbox.relpos);
      ctx.fillStyle = colors.pad;
      ctx.fillRect(0, 0, ...footprint.bbox.size);
      ctx.globalAlpha = 1;
      ctx.strokeStyle = colors.pad;
      ctx.lineWidth = 3 / scalefactor;
      ctx.strokeRect(0, 0, ...footprint.bbox.size);
      ctx.restore();
    }
  }
  // draw drawings
  for (var drawing of footprint.drawings) {
    if (drawing.layer == layer) {
      drawDrawing(ctx, scalefactor, drawing.drawing, colors.pad);
    }
  }
  ctx.lineWidth = 3 / scalefactor;
  // draw pads
  if (settings.renderPads) {
    for (var pad of footprint.pads) {
      if (pad.layers.includes(layer)) {
        drawPad(ctx, pad, colors.pad, outline);
        if (pad.pin1 &&
          (settings.highlightpin1 == "all" ||
            settings.highlightpin1 == "selected" && highlight)) {
          drawPad(ctx, pad, colors.outline, true);
        }
      }
    }
    for (var pad of footprint.pads) {
      drawPadHole(ctx, pad, colors.padHole);
    }
  }
}

function drawEdgeCuts(canvas, scalefactor) {
  var ctx = canvas.getContext("2d");
  var edgecolor = getComputedStyle(topmostdiv).getPropertyValue('--pcb-edge-color');
  for (var edge of pcbdata.edges) {
    drawDrawing(ctx, scalefactor, edge, edgecolor);
  }
}

function drawFootprints(canvas, layer, scalefactor, highlight) {
  var ctx = canvas.getContext("2d");
  ctx.lineWidth = 3 / scalefactor;
  var style = getComputedStyle(topmostdiv);

  var colors = {
    pad: style.getPropertyValue('--pad-color'),
    padHole: style.getPropertyValue('--pad-hole-color'),
    outline: style.getPropertyValue('--pin1-outline-color'),
  }

  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var mod = pcbdata.footprints[i];
    var outline = settings.renderDnpOutline && pcbdata.bom.skipped.includes(i);
    var h = highlightedFootprints.includes(i);
    var d = markedFootprints.has(i);
    if (highlight) {
      if(h && d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-both');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-both');
      } else if (h) {
        colors.pad = style.getPropertyValue('--pad-color-highlight');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight');
      } else if (d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-marked');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-marked');
      }
    }
    if( h || d || !highlight) {
      drawFootprint(ctx, layer, scalefactor, mod, colors, highlight, outline);
    }
  }
}

function drawBgLayer(layername, canvas, layer, scalefactor, edgeColor, polygonColor, textColor) {
  var ctx = canvas.getContext("2d");
  for (var d of pcbdata.drawings[layername][layer]) {
    if (["segment", "arc", "circle", "curve", "rect"].includes(d.type)) {
      drawedge(ctx, scalefactor, d, edgeColor);
    } else if (d.type == "polygon") {
      drawPolygonShape(ctx, scalefactor, d, polygonColor);
    } else {
      drawText(ctx, d, textColor);
    }
  }
}

function drawTracks(canvas, layer, defaultColor, highlight) {
  ctx = canvas.getContext("2d");
  ctx.lineCap = "round";

  var hasHole = (track) => (
    'drillsize' in track &&
    track.start[0] == track.end[0] &&
    track.start[1] == track.end[1]);

  // First draw tracks and tented vias
  for (var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    if (!hasHole(track)) {
      ctx.strokeStyle = highlight ? defaultColor : settings.netColors[track.net] || defaultColor;
      ctx.lineWidth = track.width;
      ctx.beginPath();
      if ('radius' in track) {
        ctx.arc(
          ...track.center,
          track.radius,
          deg2rad(track.startangle),
          deg2rad(track.endangle));
      } else {
        ctx.moveTo(...track.start);
        ctx.lineTo(...track.end);
      }
      ctx.stroke();
    }
  }
  // Second pass to draw untented vias
  var style = getComputedStyle(topmostdiv);
  var holeColor = style.getPropertyValue('--pad-hole-color')

  for (var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    if (hasHole(track)) {
      ctx.strokeStyle = highlight ? defaultColor : settings.netColors[track.net] || defaultColor;
      ctx.lineWidth = track.width;
      ctx.beginPath();
      ctx.moveTo(...track.start);
      ctx.lineTo(...track.end);
      ctx.stroke();
      ctx.strokeStyle = holeColor;
      ctx.lineWidth = track.drillsize;
      ctx.lineTo(...track.end);
      ctx.stroke();
    }
  }
}

function drawZones(canvas, layer, defaultColor, highlight) {
  ctx = canvas.getContext("2d");
  ctx.lineJoin = "round";
  for (var zone of pcbdata.zones[layer]) {
    if (highlight && highlightedNet != zone.net) continue;
    ctx.strokeStyle = highlight ? defaultColor : settings.netColors[zone.net] || defaultColor;
    ctx.fillStyle = highlight ? defaultColor : settings.netColors[zone.net] || defaultColor;
    if (!zone.path2d) {
      zone.path2d = getPolygonsPath(zone);
    }
    ctx.fill(zone.path2d, zone.fillrule || "nonzero");
    if (zone.width > 0) {
      ctx.lineWidth = zone.width;
      ctx.stroke(zone.path2d);
    }
  }
}

function clearCanvas(canvas, color = null) {
  var ctx = canvas.getContext("2d");
  ctx.save();
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  if (color) {
    ctx.fillStyle = color;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  } else {
    if (!window.matchMedia("print").matches)
      ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  ctx.restore();
}

function drawNets(canvas, layer, highlight) {
  var style = getComputedStyle(topmostdiv);
  if (settings.renderZones) {
    var zoneColor = style.getPropertyValue(highlight ? '--zone-color-highlight' : '--zone-color');
    drawZones(canvas, layer, zoneColor, highlight);
  }
  if (settings.renderTracks) {
    var trackColor = style.getPropertyValue(highlight ? '--track-color-highlight' : '--track-color');
    drawTracks(canvas, layer, trackColor, highlight);
  }
  if (highlight && settings.renderPads) {
    var padColor = style.getPropertyValue('--pad-color-highlight');
    var padHoleColor = style.getPropertyValue('--pad-hole-color');
    var ctx = canvas.getContext("2d");
    for (var footprint of pcbdata.footprints) {
      // draw pads
      var padDrawn = false;
      for (var pad of footprint.pads) {
        if (highlightedNet != pad.net) continue;
        if (pad.layers.includes(layer)) {
          drawPad(ctx, pad, padColor, false);
          padDrawn = true;
        }
      }
      if (padDrawn) {
        // redraw all pad holes because some pads may overlap
        for (var pad of footprint.pads) {
          drawPadHole(ctx, pad, padHoleColor);
        }
      }
    }
  }
}

function drawHighlightsOnLayer(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.highlight);
  }
  if (markedFootprints.size > 0 || highlightedFootprints.length > 0) {
    drawFootprints(canvasdict.highlight, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom, true);
  }
  if (highlightedNet !== null) {
    drawNets(canvasdict.highlight, canvasdict.layer, true);
  }
}

function drawHighlights() {
  drawHighlightsOnLayer(allcanvas.front);
  drawHighlightsOnLayer(allcanvas.back);
}

function drawBackground(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.bg);
    clearCanvas(canvasdict.fab);
    clearCanvas(canvasdict.silk);
  }

  drawNets(canvasdict.bg, canvasdict.layer, false);
  drawFootprints(canvasdict.bg, canvasdict.layer,
    canvasdict.transform.s * canvasdict.transform.zoom, false);

  drawEdgeCuts(canvasdict.bg, canvasdict.transform.s * canvasdict.transform.zoom);

  var style = getComputedStyle(topmostdiv);
  var edgeColor = style.getPropertyValue('--silkscreen-edge-color');
  var polygonColor = style.getPropertyValue('--silkscreen-polygon-color');
  var textColor = style.getPropertyValue('--silkscreen-text-color');
  if (settings.renderSilkscreen) {
    drawBgLayer(
      "silkscreen", canvasdict.silk, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
  edgeColor = style.getPropertyValue('--fabrication-edge-color');
  polygonColor = style.getPropertyValue('--fabrication-polygon-color');
  textColor = style.getPropertyValue('--fabrication-text-color');
  if (settings.renderFabrication) {
    drawBgLayer(
      "fabrication", canvasdict.fab, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
}

function prepareCanvas(canvas, flip, transform) {
  var ctx = canvas.getContext("2d");
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  ctx.scale(transform.zoom, transform.zoom);
  ctx.translate(transform.panx, transform.pany);
  if (flip) {
    ctx.scale(-1, 1);
  }
  ctx.translate(transform.x, transform.y);
  ctx.rotate(deg2rad(settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0)));
  ctx.scale(transform.s, transform.s);
}

function prepareLayer(canvasdict) {
  var flip = (canvasdict.layer === "B");
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    prepareCanvas(canvasdict[c], flip, canvasdict.transform);
  }
}

function rotateVector(v, angle) {
  angle = deg2rad(angle);
  return [
    v[0] * Math.cos(angle) - v[1] * Math.sin(angle),
    v[0] * Math.sin(angle) + v[1] * Math.cos(angle)
  ];
}

function applyRotation(bbox, flip) {
  var corners = [
    [bbox.minx, bbox.miny],
    [bbox.minx, bbox.maxy],
    [bbox.maxx, bbox.miny],
    [bbox.maxx, bbox.maxy],
  ];
  corners = corners.map((v) => rotateVector(v, settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0)));
  return {
    minx: corners.reduce((a, v) => Math.min(a, v[0]), Infinity),
    miny: corners.reduce((a, v) => Math.min(a, v[1]), Infinity),
    maxx: corners.reduce((a, v) => Math.max(a, v[0]), -Infinity),
    maxy: corners.reduce((a, v) => Math.max(a, v[1]), -Infinity),
  }
}

function recalcLayerScale(layerdict, width, height) {
  var flip = (layerdict.layer === "B");
  var bbox = applyRotation(pcbdata.edges_bbox, flip);
  var scalefactor = 0.98 * Math.min(
    width / (bbox.maxx - bbox.minx),
    height / (bbox.maxy - bbox.miny)
  );
  if (scalefactor < 0.1) {
    scalefactor = 1;
  }
  layerdict.transform.s = scalefactor;
  if (flip) {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor + width) * 0.5;
  } else {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor - width) * 0.5;
  }
  layerdict.transform.y = -((bbox.maxy + bbox.miny) * scalefactor - height) * 0.5;
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    canvas = layerdict[c];
    canvas.width = width;
    canvas.height = height;
    canvas.style.width = (width / devicePixelRatio) + "px";
    canvas.style.height = (height / devicePixelRatio) + "px";
  }
}

function redrawCanvas(layerdict) {
  prepareLayer(layerdict);
  drawBackground(layerdict);
  drawHighlightsOnLayer(layerdict);
}

function resizeCanvas(layerdict) {
  var canvasdivid = {
    "F": "frontcanvas",
    "B": "backcanvas"
  } [layerdict.layer];
  var width = document.getElementById(canvasdivid).clientWidth * devicePixelRatio;
  var height = document.getElementById(canvasdivid).clientHeight * devicePixelRatio;
  recalcLayerScale(layerdict, width, height);
  redrawCanvas(layerdict);
}

function resizeAll() {
  resizeCanvas(allcanvas.front);
  resizeCanvas(allcanvas.back);
}

function pointWithinDistanceToSegment(x, y, x1, y1, x2, y2, d) {
  var A = x - x1;
  var B = y - y1;
  var C = x2 - x1;
  var D = y2 - y1;

  var dot = A * C + B * D;
  var len_sq = C * C + D * D;
  var dx, dy;
  if (len_sq == 0) {
    // start and end of the segment coincide
    dx = x - x1;
    dy = y - y1;
  } else {
    var param = dot / len_sq;
    var xx, yy;
    if (param < 0) {
      xx = x1;
      yy = y1;
    } else if (param > 1) {
      xx = x2;
      yy = y2;
    } else {
      xx = x1 + param * C;
      yy = y1 + param * D;
    }
    dx = x - xx;
    dy = y - yy;
  }
  return dx * dx + dy * dy <= d * d;
}

function modulo(n, mod) {
  return ((n % mod) + mod) % mod;
}

function pointWithinDistanceToArc(x, y, xc, yc, radius, startangle, endangle, d) {
  var dx = x - xc;
  var dy = y - yc;
  var r_sq = dx * dx + dy * dy;
  var rmin = Math.max(0, radius - d);
  var rmax = radius + d;

  if (r_sq < rmin * rmin || r_sq > rmax * rmax)
    return false;

  var angle1 = modulo(deg2rad(startangle), 2 * Math.PI);
  var dx1 = xc + radius * Math.cos(angle1) - x;
  var dy1 = yc + radius * Math.sin(angle1) - y;
  if (dx1 * dx1 + dy1 * dy1 <= d * d)
    return true;

  var angle2 = modulo(deg2rad(endangle), 2 * Math.PI);
  var dx2 = xc + radius * Math.cos(angle2) - x;
  var dy2 = yc + radius * Math.sin(angle2) - y;
  if (dx2 * dx2 + dy2 * dy2 <= d * d)
    return true;

  var angle = modulo(Math.atan2(dy, dx), 2 * Math.PI);
  if (angle1 > angle2)
    return (angle >= angle2 || angle <= angle1);
  else
    return (angle >= angle1 && angle <= angle2);
}

function pointWithinPad(x, y, pad) {
  var v = [x - pad.pos[0], y - pad.pos[1]];
  v = rotateVector(v, pad.angle);
  if (pad.offset) {
    v[0] -= pad.offset[0];
    v[1] -= pad.offset[1];
  }
  return emptyContext2d.isPointInPath(getCachedPadPath(pad), ...v);
}

function netHitScan(layer, x, y) {
  // Check track segments
  if (settings.renderTracks && pcbdata.tracks) {
    for (var track of pcbdata.tracks[layer]) {
      if ('radius' in track) {
        if (pointWithinDistanceToArc(x, y, ...track.center, track.radius, track.startangle, track.endangle, track.width / 2)) {
          return track.net;
        }
      } else {
        if (pointWithinDistanceToSegment(x, y, ...track.start, ...track.end, track.width / 2)) {
          return track.net;
        }
      }
    }
  }
  // Check pads
  if (settings.renderPads) {
    for (var footprint of pcbdata.footprints) {
      for (var pad of footprint.pads) {
        if (pad.layers.includes(layer) && pointWithinPad(x, y, pad)) {
          return pad.net;
        }
      }
    }
  }
  return null;
}

function pointWithinFootprintBbox(x, y, bbox) {
  var v = [x - bbox.pos[0], y - bbox.pos[1]];
  v = rotateVector(v, bbox.angle);
  return bbox.relpos[0] <= v[0] && v[0] <= bbox.relpos[0] + bbox.size[0] &&
    bbox.relpos[1] <= v[1] && v[1] <= bbox.relpos[1] + bbox.size[1];
}

function bboxHitScan(layer, x, y) {
  var result = [];
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var footprint = pcbdata.footprints[i];
    if (footprint.layer == layer) {
      if (pointWithinFootprintBbox(x, y, footprint.bbox)) {
        result.push(i);
      }
    }
  }
  return result;
}

function handlePointerDown(e, layerdict) {
  if (e.button != 0 && e.button != 1) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  layerdict.pointerStates[e.pointerId] = {
    distanceTravelled: 0,
    lastX: e.offsetX,
    lastY: e.offsetY,
    downTime: Date.now(),
  };
}

function handleMouseClick(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var x = e.offsetX;
  var y = e.offsetY;
  var t = layerdict.transform;
  var flip = layerdict.layer === "B";
  if (flip) {
    x = (devicePixelRatio * x / t.zoom - t.panx + t.x) / -t.s;
  } else {
    x = (devicePixelRatio * x / t.zoom - t.panx - t.x) / t.s;
  }
  y = (devicePixelRatio * y / t.zoom - t.y - t.pany) / t.s;
  var v = rotateVector([x, y], -settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0));
  if ("nets" in pcbdata) {
    var net = netHitScan(layerdict.layer, ...v);
    if (net !== highlightedNet) {
      netClicked(net);
    }
  }
  if (highlightedNet === null) {
    var footprints = bboxHitScan(layerdict.layer, ...v);
    if (footprints.length > 0) {
      footprintsClicked(footprints);
    }
  }
}

function handlePointerLeave(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();

  if (!settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }

  delete layerdict.pointerStates[e.pointerId];
}

function resetTransform(layerdict) {
  layerdict.transform.panx = 0;
  layerdict.transform.pany = 0;
  layerdict.transform.zoom = 1;
  redrawCanvas(layerdict);
}

function handlePointerUp(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  e.preventDefault();
  e.stopPropagation();

  if (e.button == 2) {
    // Reset pan and zoom on right click.
    resetTransform(layerdict);
    layerdict.anotherPointerTapped = false;
    return;
  }

  // We haven't necessarily had a pointermove event since the interaction started, so make sure we update this now
  var ptr = layerdict.pointerStates[e.pointerId];
  ptr.distanceTravelled += Math.abs(e.offsetX - ptr.lastX) + Math.abs(e.offsetY - ptr.lastY);

  if (e.button == 0 && ptr.distanceTravelled < 10 && Date.now() - ptr.downTime <= 500) {
    if (Object.keys(layerdict.pointerStates).length == 1) {
      if (layerdict.anotherPointerTapped) {
        // This is the second pointer coming off of a two-finger tap
        resetTransform(layerdict);
      } else {
        // This is just a regular tap
        handleMouseClick(e, layerdict);
      }
      layerdict.anotherPointerTapped = false;
    } else {
      // This is the first finger coming off of what could become a two-finger tap
      layerdict.anotherPointerTapped = true;
    }
  } else {
    if (!settings.redrawOnDrag) {
      redrawCanvas(layerdict);
    }
    layerdict.anotherPointerTapped = false;
  }

  delete layerdict.pointerStates[e.pointerId];
}

function handlePointerMove(e, layerdict) {
  if (!layerdict.pointerStates.hasOwnProperty(e.pointerId)) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var thisPtr = layerdict.pointerStates[e.pointerId];

  var dx = e.offsetX - thisPtr.lastX;
  var dy = e.offsetY - thisPtr.lastY;

  // If this number is low on pointer up, we count the action as a click
  thisPtr.distanceTravelled += Math.abs(dx) + Math.abs(dy);

  if (Object.keys(layerdict.pointerStates).length == 1) {
    // This is a simple drag
    layerdict.transform.panx += devicePixelRatio * dx / layerdict.transform.zoom;
    layerdict.transform.pany += devicePixelRatio * dy / layerdict.transform.zoom;
  } else if (Object.keys(layerdict.pointerStates).length == 2) {
    var otherPtr = Object.values(layerdict.pointerStates).filter((ptr) => ptr != thisPtr)[0];

    var oldDist = Math.sqrt(Math.pow(thisPtr.lastX - otherPtr.lastX, 2) + Math.pow(thisPtr.lastY - otherPtr.lastY, 2));
    var newDist = Math.sqrt(Math.pow(e.offsetX - otherPtr.lastX, 2) + Math.pow(e.offsetY - otherPtr.lastY, 2));

    var scaleFactor = newDist / oldDist;

    if (scaleFactor != NaN) {
      layerdict.transform.zoom *= scaleFactor;

      var zoomd = (1 - scaleFactor) / layerdict.transform.zoom;
      layerdict.transform.panx += devicePixelRatio * otherPtr.lastX * zoomd;
      layerdict.transform.pany += devicePixelRatio * otherPtr.lastY * zoomd;
    }
  }

  thisPtr.lastX = e.offsetX;
  thisPtr.lastY = e.offsetY;

  if (settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }
}

function handleMouseWheel(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();
  var t = layerdict.transform;
  var wheeldelta = e.deltaY;
  if (e.deltaMode == 1) {
    // FF only, scroll by lines
    wheeldelta *= 30;
  } else if (e.deltaMode == 2) {
    wheeldelta *= 300;
  }
  var m = Math.pow(1.1, -wheeldelta / 40);
  // Limit amount of zoom per tick.
  if (m > 2) {
    m = 2;
  } else if (m < 0.5) {
    m = 0.5;
  }
  t.zoom *= m;
  var zoomd = (1 - m) / t.zoom;
  t.panx += devicePixelRatio * e.offsetX * zoomd;
  t.pany += devicePixelRatio * e.offsetY * zoomd;
  redrawCanvas(layerdict);
}

function addMouseHandlers(div, layerdict) {
  div.addEventListener("pointerdown", function(e) {
    handlePointerDown(e, layerdict);
  });
  div.addEventListener("pointermove", function(e) {
    handlePointerMove(e, layerdict);
  });
  div.addEventListener("pointerup", function(e) {
    handlePointerUp(e, layerdict);
  });
  var pointerleave = function(e) {
    handlePointerLeave(e, layerdict);
  }
  div.addEventListener("pointercancel", pointerleave);
  div.addEventListener("pointerleave", pointerleave);
  div.addEventListener("pointerout", pointerleave);

  div.onwheel = function(e) {
    handleMouseWheel(e, layerdict);
  }
  for (var element of [div, layerdict.bg, layerdict.fab, layerdict.silk, layerdict.highlight]) {
    element.addEventListener("contextmenu", function(e) {
      e.preventDefault();
    }, false);
  }
}

function setRedrawOnDrag(value) {
  settings.redrawOnDrag = value;
  writeStorage("redrawOnDrag", value);
}

function setBoardRotation(value) {
  settings.boardRotation = value * 5;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  resizeAll();
}

function setOffsetBackRotation(value) {
  settings.offsetBackRotation = value;
  writeStorage("offsetBackRotation", value);
  resizeAll();
}

function initRender() {
  allcanvas = {
    front: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("F_bg"),
      fab: document.getElementById("F_fab"),
      silk: document.getElementById("F_slk"),
      highlight: document.getElementById("F_hl"),
      layer: "F",
    },
    back: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("B_bg"),
      fab: document.getElementById("B_fab"),
      silk: document.getElementById("B_slk"),
      highlight: document.getElementById("B_hl"),
      layer: "B",
    }
  };
  addMouseHandlers(document.getElementById("frontcanvas"), allcanvas.front);
  addMouseHandlers(document.getElementById("backcanvas"), allcanvas.back);
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/*
 * Table reordering via Drag'n'Drop
 * Inspired by: https://htmldom.dev/drag-and-drop-table-column
 */

function setBomHandlers() {

  const bom = document.getElementById('bomtable');

  let dragName;
  let placeHolderElements;
  let draggingElement;
  let forcePopulation;
  let xOffset;
  let yOffset;
  let wasDragged;

  const mouseUpHandler = function(e) {
    // Delete dragging element
    draggingElement.remove();

    // Make BOM selectable again
    bom.style.removeProperty("userSelect");

    // Remove listeners
    document.removeEventListener('mousemove', mouseMoveHandler);
    document.removeEventListener('mouseup', mouseUpHandler);

    if (wasDragged) {
      // Redraw whole BOM
      populateBomTable();
    }
  }

  const mouseMoveHandler = function(e) {
    // Notice the dragging
    wasDragged = true;

    // Make the dragged element visible
    draggingElement.style.removeProperty("display");

    // Set elements position to mouse position
    draggingElement.style.left = `${e.screenX - xOffset}px`;
    draggingElement.style.top = `${e.screenY - yOffset}px`;

    // Forced redrawing of BOM table
    if (forcePopulation) {
      forcePopulation = false;
      // Copy array
      phe = Array.from(placeHolderElements);
      // populate BOM table again
      populateBomHeader(dragName, phe);
      populateBomBody(dragName, phe);
    }

    // Set up array of hidden columns
    var hiddenColumns = Array.from(settings.hiddenColumns);
    // In the ungrouped mode, quantity don't exist
    if (settings.bommode === "ungrouped")
      hiddenColumns.push("Quantity");
    // If no checkbox fields can be found, we consider them hidden
    if (settings.checkboxes.length == 0)
      hiddenColumns.push("checkboxes");

    // Get table headers and group them into checkboxes, extrafields and normal headers
    const bh = document.getElementById("bomhead");
    headers = Array.from(bh.querySelectorAll("th"))
    headers.shift() // numCol is not part of the columnOrder
    headerGroups = []
    lastCompoundClass = null;
    for (i = 0; i < settings.columnOrder.length; i++) {
      cElem = settings.columnOrder[i];
      if (hiddenColumns.includes(cElem)) {
        // Hidden columns appear as a dummy element
        headerGroups.push([]);
        continue;
      }
      elem = headers.filter(e => getColumnOrderName(e) === cElem)[0];
      if (elem.classList.contains("bom-checkbox")) {
        if (lastCompoundClass === "bom-checkbox") {
          cbGroup = headerGroups.pop();
          cbGroup.push(elem);
          headerGroups.push(cbGroup);
        } else {
          lastCompoundClass = "bom-checkbox";
          headerGroups.push([elem])
        }
      } else {
        headerGroups.push([elem])
      }
    }

    // Copy settings.columnOrder
    var columns = Array.from(settings.columnOrder)

    // Set up array with indices of hidden columns
    var hiddenIndices = hiddenColumns.map(e => settings.columnOrder.indexOf(e));
    var dragIndex = columns.indexOf(dragName);
    var swapIndex = dragIndex;
    var swapDone = false;

    // Check if the current dragged element is swapable with the left or right element
    if (dragIndex > 0) {
      // Get left headers boundingbox
      swapIndex = dragIndex - 1;
      while (hiddenIndices.includes(swapIndex) && swapIndex > 0)
        swapIndex--;
      if (!hiddenIndices.includes(swapIndex)) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX < box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }
    if ((!swapDone) && dragIndex < headerGroups.length - 1) {
      // Get right headers boundingbox
      swapIndex = dragIndex + 1;
      while (hiddenIndices.includes(swapIndex))
        swapIndex++;
      if (swapIndex < headerGroups.length) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX > box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }

    // Write back change to storage
    if (swapDone) {
      settings.columnOrder = columns
      writeStorage("columnOrder", JSON.stringify(columns));
    }

  }

  const mouseDownHandler = function(e) {
    var target = e.target;
    if (target.tagName.toLowerCase() != "td")
      target = target.parentElement;

    // Used to check if a dragging has ever happened
    wasDragged = false;

    // Create new element which will be displayed as the dragged column
    draggingElement = document.createElement("div")
    draggingElement.classList.add("dragging");
    draggingElement.style.display = "none";
    draggingElement.style.position = "absolute";
    draggingElement.style.overflow = "hidden";

    // Get bomhead and bombody elements
    const bh = document.getElementById("bomhead");
    const bb = document.getElementById("bombody");

    // Get all compound headers for the current column
    var compoundHeaders;
    if (target.classList.contains("bom-checkbox")) {
      compoundHeaders = Array.from(bh.querySelectorAll("th.bom-checkbox"));
    } else {
      compoundHeaders = [target];
    }

    // Create new table which will display the column
    var newTable = document.createElement("table");
    newTable.classList.add("bom");
    newTable.style.background = "white";
    draggingElement.append(newTable);

    // Create new header element
    var newHeader = document.createElement("thead");
    newTable.append(newHeader);

    // Set up array for storing all placeholder elements
    placeHolderElements = [];

    // Add all compound headers to the new thead element and placeholders
    compoundHeaders.forEach(function(h) {
      clone = cloneElementWithDimensions(h);
      newHeader.append(clone);
      placeHolderElements.push(clone);
    });

    // Create new body element
    var newBody = document.createElement("tbody");
    newTable.append(newBody);

    // Get indices for compound headers
    var idxs = compoundHeaders.map(e => getBomTableHeaderIndex(e));

    // For each row in the BOM body...
    var rows = bb.querySelectorAll("tr");
    rows.forEach(function(row) {
      // ..get the cells for the compound column
      const tds = row.querySelectorAll("td");
      var copytds = idxs.map(i => tds[i]);
      // Add them to the new element and the placeholders
      var newRow = document.createElement("tr");
      copytds.forEach(function(td) {
        clone = cloneElementWithDimensions(td);
        newRow.append(clone);
        placeHolderElements.push(clone);
      });
      newBody.append(newRow);
    });

    // Compute width for compound header
    var width = compoundHeaders.reduce((acc, x) => acc + x.clientWidth, 0);
    draggingElement.style.width = `${width}px`;

    // Insert the new dragging element and disable selection on BOM
    bom.insertBefore(draggingElement, null);
    bom.style.userSelect = "none";

    // Determine the mouse position offset
    xOffset = e.screenX - compoundHeaders.reduce((acc, x) => Math.min(acc, x.offsetLeft), compoundHeaders[0].offsetLeft);
    yOffset = e.screenY - compoundHeaders[0].offsetTop;

    // Get name for the column in settings.columnOrder
    dragName = getColumnOrderName(target);

    // Change text and class for placeholder elements
    placeHolderElements = placeHolderElements.map(function(e) {
      newElem = cloneElementWithDimensions(e);
      newElem.textContent = "";
      newElem.classList.add("placeholder");
      return newElem;
    });

    // On next mouse move, the whole BOM needs to be redrawn to show the placeholders
    forcePopulation = true;

    // Add listeners for move and up on mouse
    document.addEventListener('mousemove', mouseMoveHandler);
    document.addEventListener('mouseup', mouseUpHandler);
  }

  // In netlist mode, there is nothing to reorder
  if (settings.bommode === "netlist")
    return;

  // Add mouseDownHandler to every column except the numCol
  bom.querySelectorAll("th")
    .forEach(function(head) {
      if (!head.classList.contains("numCol")) {
        head.onmousedown = mouseDownHandler;
      }
    });

}

function getBoundingClientRectFromMultiple(elements) {
  var elems = Array.from(elements);

  if (elems.length == 0)
    return null;

  var box = elems.shift()
    .getBoundingClientRect();

  elems.forEach(function(elem) {
    var elembox = elem.getBoundingClientRect();
    box.left = Math.min(elembox.left, box.left);
    box.top = Math.min(elembox.top, box.top);
    box.width += elembox.width;
    box.height = Math.max(elembox.height, box.height);
  });

  return box;
}

function cloneElementWithDimensions(elem) {
  var newElem = elem.cloneNode(true);
  newElem.style.height = window.getComputedStyle(elem).height;
  newElem.style.width = window.getComputedStyle(elem).width;
  return newElem;
}

function getBomTableHeaderIndex(elem) {
  const bh = document.getElementById('bomhead');
  const ths = Array.from(bh.querySelectorAll("th"));
  return ths.indexOf(elem);
}

function getColumnOrderName(elem) {
  var cname = elem.getAttribute("col_name");
  if (cname === "bom-checkbox")
    return "checkboxes";
  else
    return cname;
}

function resizableGrid(tablehead) {
  var cols = tablehead.firstElementChild.children;
  var rowWidth = tablehead.offsetWidth;

  for (var i = 1; i < cols.length; i++) {
    if (cols[i].classList.contains("bom-checkbox"))
      continue;
    cols[i].style.width = ((cols[i].clientWidth - paddingDiff(cols[i])) * 100 / rowWidth) + '%';
  }

  for (var i = 1; i < cols.length - 1; i++) {
    var div = document.createElement('div');
    div.className = "column-width-handle";
    cols[i].appendChild(div);
    setListeners(div);
  }

  function setListeners(div) {
    var startX, curCol, nxtCol, curColWidth, nxtColWidth, rowWidth;

    div.addEventListener('mousedown', function(e) {
      e.preventDefault();
      e.stopPropagation();

      curCol = e.target.parentElement;
      nxtCol = curCol.nextElementSibling;
      startX = e.pageX;

      var padding = paddingDiff(curCol);

      rowWidth = curCol.parentElement.offsetWidth;
      curColWidth = curCol.clientWidth - padding;
      nxtColWidth = nxtCol.clientWidth - padding;
    });

    document.addEventListener('mousemove', function(e) {
      if (startX) {
        var diffX = e.pageX - startX;
        diffX = -Math.min(-diffX, curColWidth - 20);
        diffX = Math.min(diffX, nxtColWidth - 20);

        curCol.style.width = ((curColWidth + diffX) * 100 / rowWidth) + '%';
        nxtCol.style.width = ((nxtColWidth - diffX) * 100 / rowWidth) + '%';
        console.log(`${curColWidth + nxtColWidth} ${(curColWidth + diffX) * 100 / rowWidth + (nxtColWidth - diffX) * 100 / rowWidth}`);
      }
    });

    document.addEventListener('mouseup', function(e) {
      curCol = undefined;
      nxtCol = undefined;
      startX = undefined;
      nxtColWidth = undefined;
      curColWidth = undefined
    });
  }

  function paddingDiff(col) {

    if (getStyleVal(col, 'box-sizing') == 'border-box') {
      return 0;
    }

    var padLeft = getStyleVal(col, 'padding-left');
    var padRight = getStyleVal(col, 'padding-right');
    return (parseInt(padLeft) + parseInt(padRight));

  }

  function getStyleVal(elm, css) {
    return (window.getComputedStyle(elm, null).getPropertyValue(css))
  }
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/* DOM manipulation and misc code */

var bomsplit;
var canvassplit;
var initDone = false;
var bomSortFunction = null;
var currentSortColumn = null;
var currentSortOrder = null;
var currentHighlightedRowId;
var highlightHandlers = [];
var footprintIndexToHandler = {};
var netsToHandler = {};
var markedFootprints = new Set();
var highlightedFootprints = [];
var highlightedNet = null;
var lastClicked;

function dbg(html) {
  dbgdiv.innerHTML = html;
}

function redrawIfInitDone() {
  if (initDone) {
    redrawCanvas(allcanvas.front);
    redrawCanvas(allcanvas.back);
  }
}

function padsVisible(value) {
  writeStorage("padsVisible", value);
  settings.renderPads = value;
  redrawIfInitDone();
}

function referencesVisible(value) {
  writeStorage("referencesVisible", value);
  settings.renderReferences = value;
  redrawIfInitDone();
}

function valuesVisible(value) {
  writeStorage("valuesVisible", value);
  settings.renderValues = value;
  redrawIfInitDone();
}

function tracksVisible(value) {
  writeStorage("tracksVisible", value);
  settings.renderTracks = value;
  redrawIfInitDone();
}

function zonesVisible(value) {
  writeStorage("zonesVisible", value);
  settings.renderZones = value;
  redrawIfInitDone();
}

function dnpOutline(value) {
  writeStorage("dnpOutline", value);
  settings.renderDnpOutline = value;
  redrawIfInitDone();
}

function setDarkMode(value) {
  if (value) {
    topmostdiv.classList.add("dark");
  } else {
    topmostdiv.classList.remove("dark");
  }
  writeStorage("darkmode", value);
  settings.darkMode = value;
  redrawIfInitDone();
  if (initDone) {
    populateBomTable();
  }
}

function setShowBOMColumn(field, value) {
  if (field === "references") {
    var rl = document.getElementById("reflookup");
    rl.disabled = !value;
    if (!value) {
      rl.value = "";
      updateRefLookup("");
    }
  }

  var n = settings.hiddenColumns.indexOf(field);
  if (value) {
    if (n != -1) {
      settings.hiddenColumns.splice(n, 1);
    }
  } else {
    if (n == -1) {
      settings.hiddenColumns.push(field);
    }
  }

  writeStorage("hiddenColumns", JSON.stringify(settings.hiddenColumns));

  if (initDone) {
    populateBomTable();
  }

  redrawIfInitDone();
}


function setFullscreen(value) {
  if (value) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
}

function fabricationVisible(value) {
  writeStorage("fabricationVisible", value);
  settings.renderFabrication = value;
  redrawIfInitDone();
}

function silkscreenVisible(value) {
  writeStorage("silkscreenVisible", value);
  settings.renderSilkscreen = value;
  redrawIfInitDone();
}

function setHighlightPin1(value) {
  writeStorage("highlightpin1", value);
  settings.highlightpin1 = value;
  redrawIfInitDone();
}

function getStoredCheckboxRefs(checkbox) {
  function convert(ref) {
    var intref = parseInt(ref);
    if (isNaN(intref)) {
      for (var i = 0; i < pcbdata.footprints.length; i++) {
        if (pcbdata.footprints[i].ref == ref) {
          return i;
        }
      }
      return -1;
    } else {
      return intref;
    }
  }
  if (!(checkbox in settings.checkboxStoredRefs)) {
    var val = readStorage("checkbox_" + checkbox);
    settings.checkboxStoredRefs[checkbox] = val ? val : "";
  }
  if (!settings.checkboxStoredRefs[checkbox]) {
    return new Set();
  } else {
    return new Set(settings.checkboxStoredRefs[checkbox].split(",").map(r => convert(r)).filter(a => a >= 0));
  }
}

function getCheckboxState(checkbox, references) {
  var storedRefsSet = getStoredCheckboxRefs(checkbox);
  var currentRefsSet = new Set(references.map(r => r[1]));
  // Get difference of current - stored
  var difference = new Set(currentRefsSet);
  for (ref of storedRefsSet) {
    difference.delete(ref);
  }
  if (difference.size == 0) {
    // All the current refs are stored
    return "checked";
  } else if (difference.size == currentRefsSet.size) {
    // None of the current refs are stored
    return "unchecked";
  } else {
    // Some of the refs are stored
    return "indeterminate";
  }
}

function setBomCheckboxState(checkbox, element, references) {
  var state = getCheckboxState(checkbox, references);
  element.checked = (state == "checked");
  element.indeterminate = (state == "indeterminate");
}

function createCheckboxChangeHandler(checkbox, references, row) {
  return function () {
    refsSet = getStoredCheckboxRefs(checkbox);
    var markWhenChecked = settings.markWhenChecked == checkbox;
    eventArgs = {
      checkbox: checkbox,
      refs: references,
    }
    if (this.checked) {
      // checkbox ticked
      for (var ref of references) {
        refsSet.add(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.add("checked");
        for (var ref of references) {
          markedFootprints.add(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'checked';
    } else {
      // checkbox unticked
      for (var ref of references) {
        refsSet.delete(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.remove("checked");
        for (var ref of references) {
          markedFootprints.delete(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'unchecked';
    }
    settings.checkboxStoredRefs[checkbox] = [...refsSet].join(",");
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
    updateCheckboxStats(checkbox);
    EventHandler.emitEvent(IBOM_EVENT_TYPES.CHECKBOX_CHANGE_EVENT, eventArgs);
  }
}

function clearHighlightedFootprints() {
  if (currentHighlightedRowId) {
    document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    currentHighlightedRowId = null;
    highlightedFootprints = [];
    highlightedNet = null;
  }
}

function createRowHighlightHandler(rowid, refs, net) {
  return function () {
    if (currentHighlightedRowId) {
      if (currentHighlightedRowId == rowid) {
        return;
      }
      document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    }
    document.getElementById(rowid).classList.add("highlighted");
    currentHighlightedRowId = rowid;
    highlightedFootprints = refs ? refs.map(r => r[1]) : [];
    highlightedNet = net;
    drawHighlights();
    EventHandler.emitEvent(
      IBOM_EVENT_TYPES.HIGHLIGHT_EVENT, {
      rowid: rowid,
      refs: refs,
      net: net
    });
  }
}

function updateNetColors() {
  writeStorage("netColors", JSON.stringify(settings.netColors));
  redrawIfInitDone();
}

function netColorChangeHandler(net) {
  return (event) => {
    settings.netColors[net] = event.target.value;
    updateNetColors();
  }
}

function netColorRightClick(net) {
  return (event) => {
    if (event.button == 2) {
      event.preventDefault();
      event.stopPropagation();

      var style = getComputedStyle(topmostdiv);
      var defaultNetColor = style.getPropertyValue('--track-color').trim();
      event.target.value = defaultNetColor;
      delete settings.netColors[net];
      updateNetColors();
    }
  }
}

function entryMatches(entry) {
  if (settings.bommode == "netlist") {
    // entry is just a net name
    return entry.toLowerCase().indexOf(filter) >= 0;
  }
  // check refs
  if (!settings.hiddenColumns.includes("references")) {
    for (var ref of entry) {
      if (ref[0].toLowerCase().indexOf(filter) >= 0) {
        return true;
      }
    }
  }
  // check fields
  for (var i in config.fields) {
    var f = config.fields[i];
    if (!settings.hiddenColumns.includes(f)) {
      for (var ref of entry) {
        if (String(pcbdata.bom.fields[ref[1]][i]).toLowerCase().indexOf(filter) >= 0) {
          return true;
        }
      }
    }
  }
  return false;
}

function findRefInEntry(entry) {
  return entry.filter(r => r[0].toLowerCase() == reflookup);
}

function highlightFilter(s) {
  if (!filter) {
    return s;
  }
  var parts = s.toLowerCase().split(filter);
  if (parts.length == 1) {
    return s;
  }
  var r = "";
  var pos = 0;
  for (var i in parts) {
    if (i > 0) {
      r += '<mark class="highlight">' +
        s.substring(pos, pos + filter.length) +
        '</mark>';
      pos += filter.length;
    }
    r += s.substring(pos, pos + parts[i].length);
    pos += parts[i].length;
  }
  return r;
}

function checkboxSetUnsetAllHandler(checkboxname) {
  return function () {
    var checkboxnum = 0;
    while (checkboxnum < settings.checkboxes.length &&
      settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
      checkboxnum++;
    }
    if (checkboxnum >= settings.checkboxes.length) {
      return;
    }
    var allset = true;
    var checkbox;
    var row;
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      if (!checkbox.checked || checkbox.indeterminate) {
        allset = false;
        break;
      }
    }
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      checkbox.checked = !allset;
      checkbox.indeterminate = false;
      checkbox.onchange();
    }
  }
}

function createColumnHeader(name, cls, comparator, is_checkbox = false) {
  var th = document.createElement("TH");
  th.innerHTML = name;
  th.classList.add(cls);
  if (is_checkbox)
    th.setAttribute("col_name", "bom-checkbox");
  else
    th.setAttribute("col_name", name);
  var span = document.createElement("SPAN");
  span.classList.add("sortmark");
  span.classList.add("none");
  th.appendChild(span);
  var spacer = document.createElement("div");
  spacer.className = "column-spacer";
  th.appendChild(spacer);
  spacer.onclick = function () {
    if (currentSortColumn && th !== currentSortColumn) {
      // Currently sorted by another column
      currentSortColumn.childNodes[1].classList.remove(currentSortOrder);
      currentSortColumn.childNodes[1].classList.add("none");
      currentSortColumn = null;
      currentSortOrder = null;
    }
    if (currentSortColumn && th === currentSortColumn) {
      // Already sorted by this column
      if (currentSortOrder == "asc") {
        // Sort by this column, descending order
        bomSortFunction = function (a, b) {
          return -comparator(a, b);
        }
        currentSortColumn.childNodes[1].classList.remove("asc");
        currentSortColumn.childNodes[1].classList.add("desc");
        currentSortOrder = "desc";
      } else {
        // Unsort
        bomSortFunction = null;
        currentSortColumn.childNodes[1].classList.remove("desc");
        currentSortColumn.childNodes[1].classList.add("none");
        currentSortColumn = null;
        currentSortOrder = null;
      }
    } else {
      // Sort by this column, ascending order
      bomSortFunction = comparator;
      currentSortColumn = th;
      currentSortColumn.childNodes[1].classList.remove("none");
      currentSortColumn.childNodes[1].classList.add("asc");
      currentSortOrder = "asc";
    }
    populateBomBody();
  }
  if (is_checkbox) {
    spacer.onclick = fancyDblClickHandler(
      spacer, spacer.onclick, checkboxSetUnsetAllHandler(name));
  }
  return th;
}

function populateBomHeader(placeHolderColumn = null, placeHolderElements = null) {
  while (bomhead.firstChild) {
    bomhead.removeChild(bomhead.firstChild);
  }
  var tr = document.createElement("TR");
  var th = document.createElement("TH");
  th.classList.add("numCol");

  var vismenu = document.createElement("div");
  vismenu.id = "vismenu";
  vismenu.classList.add("menu");

  var visbutton = document.createElement("div");
  visbutton.classList.add("visbtn");
  visbutton.classList.add("hideonprint");

  var viscontent = document.createElement("div");
  viscontent.classList.add("menu-content");
  viscontent.id = "vismenu-content";

  settings.columnOrder.forEach(column => {
    if (typeof column !== "string")
      return;

    // Skip empty columns
    if (column === "checkboxes" && settings.checkboxes.length == 0)
      return;
    else if (column === "Quantity" && settings.bommode == "ungrouped")
      return;

    var label = document.createElement("label");
    label.classList.add("menu-label");

    var input = document.createElement("input");
    input.classList.add("visibility_checkbox");
    input.type = "checkbox";
    input.onchange = function (e) {
      setShowBOMColumn(column, e.target.checked)
    };
    input.checked = !(settings.hiddenColumns.includes(column));

    label.appendChild(input);
    if (column.length > 0)
      label.append(column[0].toUpperCase() + column.slice(1));

    viscontent.appendChild(label);
  });

  viscontent.childNodes[0].classList.add("menu-label-top");

  vismenu.appendChild(visbutton);
  if (settings.bommode != "netlist") {
    vismenu.appendChild(viscontent);
    th.appendChild(vismenu);
  }
  tr.appendChild(th);

  var checkboxCompareClosure = function (checkbox) {
    return (a, b) => {
      var stateA = getCheckboxState(checkbox, a);
      var stateB = getCheckboxState(checkbox, b);
      if (stateA > stateB) return -1;
      if (stateA < stateB) return 1;
      return 0;
    }
  }
  var stringFieldCompareClosure = function (fieldIndex) {
    return (a, b) => {
      var fa = pcbdata.bom.fields[a[0][1]][fieldIndex];
      var fb = pcbdata.bom.fields[b[0][1]][fieldIndex];
      if (fa != fb) return fa > fb ? 1 : -1;
      else return 0;
    }
  }
  var referenceRegex = /(?<prefix>[^0-9]+)(?<number>[0-9]+)/;
  var compareRefs = (a, b) => {
    var ra = referenceRegex.exec(a);
    var rb = referenceRegex.exec(b);
    if (ra === null || rb === null) {
      if (a != b) return a > b ? 1 : -1;
      return 0;
    } else {
      if (ra.groups.prefix != rb.groups.prefix) {
        return ra.groups.prefix > rb.groups.prefix ? 1 : -1;
      }
      if (ra.groups.number != rb.groups.number) {
        return parseInt(ra.groups.number) > parseInt(rb.groups.number) ? 1 : -1;
      }
      return 0;
    }
  }
  if (settings.bommode == "netlist") {
    tr.appendChild(createColumnHeader("Net name", "bom-netname", (a, b) => {
      if (a > b) return -1;
      if (a < b) return 1;
      return 0;
    }));
    tr.appendChild(createColumnHeader("Color", "bom-color", (a, b) => {
      return 0;
    }));
  } else {
    // Filter hidden columns
    var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
    var valueIndex = config.fields.indexOf("Value");
    var footprintIndex = config.fields.indexOf("Footprint");
    columns.forEach((column) => {
      if (column === placeHolderColumn) {
        var n = 1;
        if (column === "checkboxes")
          n = settings.checkboxes.length;
        for (i = 0; i < n; i++) {
          td = placeHolderElements.shift();
          tr.appendChild(td);
        }
        return;
      } else if (column === "checkboxes") {
        for (var checkbox of settings.checkboxes) {
          th = createColumnHeader(
            checkbox, "bom-checkbox", checkboxCompareClosure(checkbox), true);
          tr.appendChild(th);
        }
      } else if (column === "References") {
        tr.appendChild(createColumnHeader("References", "references", (a, b) => {
          var i = 0;
          while (i < a.length && i < b.length) {
            if (a[i] != b[i]) return compareRefs(a[i][0], b[i][0]);
            i++;
          }
          return a.length - b.length;
        }));
      } else if (column === "Value") {
        tr.appendChild(createColumnHeader("Value", "value", (a, b) => {
          var ra = a[0][1], rb = b[0][1];
          return valueCompare(
            pcbdata.bom.parsedValues[ra], pcbdata.bom.parsedValues[rb],
            pcbdata.bom.fields[ra][valueIndex], pcbdata.bom.fields[rb][valueIndex]);
        }));
        return;
      } else if (column === "Footprint") {
        tr.appendChild(createColumnHeader(
          "Footprint", "footprint", stringFieldCompareClosure(footprintIndex)));
      } else if (column === "Quantity" && settings.bommode == "grouped") {
        tr.appendChild(createColumnHeader("Quantity", "quantity", (a, b) => {
          return a.length - b.length;
        }));
      } else {
        // Other fields
        var i = config.fields.indexOf(column);
        if (i < 0)
          return;
        tr.appendChild(createColumnHeader(
          column, `field${i + 1}`, stringFieldCompareClosure(i)));
      }
    });
  }
  bomhead.appendChild(tr);
}

function populateBomBody(placeholderColumn = null, placeHolderElements = null) {
  const urlRegex = /^(https?:\/\/[^\s\/$.?#][^\s]*|file:\/\/([a-zA-Z]:|\/)[^\x00]+)$/;
  while (bom.firstChild) {
    bom.removeChild(bom.firstChild);
  }
  highlightHandlers = [];
  footprintIndexToHandler = {};
  netsToHandler = {};
  currentHighlightedRowId = null;
  var first = true;
  var style = getComputedStyle(topmostdiv);
  var defaultNetColor = style.getPropertyValue('--track-color').trim();
  if (settings.bommode == "netlist") {
    bomtable = pcbdata.nets.slice();
  } else {
    switch (settings.canvaslayout) {
      case 'F':
        bomtable = pcbdata.bom.F.slice();
        break;
      case 'FB':
        bomtable = pcbdata.bom.both.slice();
        break;
      case 'B':
        bomtable = pcbdata.bom.B.slice();
        break;
    }
    if (settings.bommode == "ungrouped") {
      // expand bom table
      expandedTable = []
      for (var bomentry of bomtable) {
        for (var ref of bomentry) {
          expandedTable.push([ref]);
        }
      }
      bomtable = expandedTable;
    }
  }
  if (bomSortFunction) {
    bomtable = bomtable.sort(bomSortFunction);
  }
  for (var i in bomtable) {
    var bomentry = bomtable[i];
    if (filter && !entryMatches(bomentry)) {
      continue;
    }
    var references = null;
    var netname = null;
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    var rownum = +i + 1;
    tr.id = "bomrow" + rownum;
    td.textContent = rownum;
    tr.appendChild(td);
    if (settings.bommode == "netlist") {
      netname = bomentry;
      td = document.createElement("TD");
      td.innerHTML = highlightFilter(netname ? netname : "&lt;no net&gt;");
      tr.appendChild(td);
      var color = settings.netColors[netname] || defaultNetColor;
      td = document.createElement("TD");
      var colorBox = document.createElement("INPUT");
      colorBox.type = "color";
      colorBox.value = color;
      colorBox.onchange = netColorChangeHandler(netname);
      colorBox.onmouseup = netColorRightClick(netname);
      colorBox.oncontextmenu = (e) => e.preventDefault();
      td.appendChild(colorBox);
      td.classList.add("color-column");
      tr.appendChild(td);
    } else {
      if (reflookup) {
        references = findRefInEntry(bomentry);
        if (references.length == 0) {
          continue;
        }
      } else {
        references = bomentry;
      }
      // Filter hidden columns
      var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
      columns.forEach((column) => {
        if (column === placeholderColumn) {
          var n = 1;
          if (column === "checkboxes")
            n = settings.checkboxes.length;
          for (i = 0; i < n; i++) {
            td = placeHolderElements.shift();
            tr.appendChild(td);
          }
          return;
        } else if (column === "checkboxes") {
          for (var checkbox of settings.checkboxes) {
            if (checkbox) {
              td = document.createElement("TD");
              var input = document.createElement("input");
              input.type = "checkbox";
              input.onchange = createCheckboxChangeHandler(checkbox, references, tr);
              setBomCheckboxState(checkbox, input, references);
              if (input.checked && settings.markWhenChecked == checkbox) {
                tr.classList.add("checked");
              }
              td.appendChild(input);
              tr.appendChild(td);
            }
          }
        } else if (column === "References") {
          td = document.createElement("TD");
          td.innerHTML = highlightFilter(references.map(r => r[0]).join(", "));
          tr.appendChild(td);
        } else if (column === "Quantity" && settings.bommode == "grouped") {
          // Quantity
          td = document.createElement("TD");
          td.textContent = references.length;
          tr.appendChild(td);
        } else {
          // All the other fields
          var field_index = config.fields.indexOf(column)
          if (field_index < 0)
            return;
          var valueSet = new Set();
          references.map(r => r[1]).forEach((id) => valueSet.add(pcbdata.bom.fields[id][field_index]));
          td = document.createElement("TD");
          var output = new Array();
          for (let item of valueSet) {
            const visible = highlightFilter(String(item));
            if (typeof item === 'string' && item.match(urlRegex)) {
              output.push(`<a href="${item}" target="_blank">${visible}</a>`);
            } else {
              output.push(visible);
            }
          }
          td.innerHTML = output.join(", ");
          tr.appendChild(td);
        }
      });
    }
    bom.appendChild(tr);
    var handler = createRowHighlightHandler(tr.id, references, netname);
    tr.onmousemove = handler;
    highlightHandlers.push({
      id: tr.id,
      handler: handler,
    });
    if (references !== null) {
      for (var refIndex of references.map(r => r[1])) {
        footprintIndexToHandler[refIndex] = handler;
      }
    }
    if (netname !== null) {
      netsToHandler[netname] = handler;
    }
    if ((filter || reflookup) && first) {
      handler();
      first = false;
    }
  }
  EventHandler.emitEvent(
    IBOM_EVENT_TYPES.BOM_BODY_CHANGE_EVENT, {
    filter: filter,
    reflookup: reflookup,
    checkboxes: settings.checkboxes,
    bommode: settings.bommode,
  });
}

function highlightPreviousRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[highlightHandlers.length - 1].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[0].id == currentHighlightedRowId) {
      highlightHandlers[highlightHandlers.length - 1].handler();
    } else {
      for (var i = 0; i < highlightHandlers.length - 1; i++) {
        if (highlightHandlers[i + 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function highlightNextRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[0].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[highlightHandlers.length - 1].id == currentHighlightedRowId) {
      highlightHandlers[0].handler();
    } else {
      for (var i = 1; i < highlightHandlers.length; i++) {
        if (highlightHandlers[i - 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function populateBomTable() {
  populateBomHeader();
  populateBomBody();
  setBomHandlers();
  resizableGrid(bomhead);
}

function footprintsClicked(footprintIndexes) {
  var lastClickedIndex = footprintIndexes.indexOf(lastClicked);
  for (var i = 1; i <= footprintIndexes.length; i++) {
    var refIndex = footprintIndexes[(lastClickedIndex + i) % footprintIndexes.length];
    if (refIndex in footprintIndexToHandler) {
      lastClicked = refIndex;
      footprintIndexToHandler[refIndex]();
      smoothScrollToRow(currentHighlightedRowId);
      break;
    }
  }
}

function netClicked(net) {
  if (net in netsToHandler) {
    netsToHandler[net]();
    smoothScrollToRow(currentHighlightedRowId);
  } else {
    clearHighlightedFootprints();
    highlightedNet = net;
    drawHighlights();
  }
}

function updateFilter(input) {
  filter = input.toLowerCase();
  populateBomTable();
}

function updateRefLookup(input) {
  reflookup = input.toLowerCase();
  populateBomTable();
}

function changeCanvasLayout(layout) {
  document.getElementById("fl-btn").classList.remove("depressed");
  document.getElementById("fb-btn").classList.remove("depressed");
  document.getElementById("bl-btn").classList.remove("depressed");
  switch (layout) {
    case 'F':
      document.getElementById("fl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(1);
      }
      break;
    case 'B':
      document.getElementById("bl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(0);
      }
      break;
    default:
      document.getElementById("fb-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.setSizes([50, 50]);
      }
  }
  settings.canvaslayout = layout;
  writeStorage("canvaslayout", layout);
  resizeAll();
  changeBomMode(settings.bommode);
}

function populateMetadata() {
  document.getElementById("title").innerHTML = pcbdata.metadata.title;
  document.getElementById("revision").innerHTML = "Rev: " + pcbdata.metadata.revision;
  document.getElementById("company").innerHTML = pcbdata.metadata.company;
  document.getElementById("filedate").innerHTML = pcbdata.metadata.date;
  if (pcbdata.metadata.title != "") {
    document.title = pcbdata.metadata.title + " BOM";
  }
  // Calculate board stats
  var fp_f = 0,
    fp_b = 0,
    pads_f = 0,
    pads_b = 0,
    pads_th = 0;
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    if (pcbdata.bom.skipped.includes(i)) continue;
    var mod = pcbdata.footprints[i];
    if (mod.layer == "F") {
      fp_f++;
    } else {
      fp_b++;
    }
    for (var pad of mod.pads) {
      if (pad.type == "th") {
        pads_th++;
      } else {
        if (pad.layers.includes("F")) {
          pads_f++;
        }
        if (pad.layers.includes("B")) {
          pads_b++;
        }
      }
    }
  }
  document.getElementById("stats-components-front").innerHTML = fp_f;
  document.getElementById("stats-components-back").innerHTML = fp_b;
  document.getElementById("stats-components-total").innerHTML = fp_f + fp_b;
  document.getElementById("stats-groups-front").innerHTML = pcbdata.bom.F.length;
  document.getElementById("stats-groups-back").innerHTML = pcbdata.bom.B.length;
  document.getElementById("stats-groups-total").innerHTML = pcbdata.bom.both.length;
  document.getElementById("stats-smd-pads-front").innerHTML = pads_f;
  document.getElementById("stats-smd-pads-back").innerHTML = pads_b;
  document.getElementById("stats-smd-pads-total").innerHTML = pads_f + pads_b;
  document.getElementById("stats-th-pads").innerHTML = pads_th;
  // Update version string
  document.getElementById("github-link").innerHTML = "InteractiveHtmlBom&nbsp;" +
    /^v\d+\.\d+/.exec(pcbdata.ibom_version)[0];
}

function changeBomLayout(layout) {
  document.getElementById("bom-btn").classList.remove("depressed");
  document.getElementById("lr-btn").classList.remove("depressed");
  document.getElementById("tb-btn").classList.remove("depressed");
  switch (layout) {
    case 'bom-only':
      document.getElementById("bom-btn").classList.add("depressed");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      document.getElementById("frontcanvas").style.display = "none";
      document.getElementById("backcanvas").style.display = "none";
      document.getElementById("topmostdiv").style.height = "";
      document.getElementById("topmostdiv").style.display = "block";
      break;
    case 'top-bottom':
      document.getElementById("tb-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("topmostdiv").style.height = "100%";
      document.getElementById("topmostdiv").style.display = "flex";
      document.getElementById("bomdiv").classList.remove("split-horizontal");
      document.getElementById("canvasdiv").classList.remove("split-horizontal");
      document.getElementById("frontcanvas").classList.add("split-horizontal");
      document.getElementById("backcanvas").classList.add("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        direction: "vertical",
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        onDragEnd: resizeAll
      });
      break;
    case 'left-right':
      document.getElementById("lr-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("topmostdiv").style.height = "100%";
      document.getElementById("topmostdiv").style.display = "flex";
      document.getElementById("bomdiv").classList.add("split-horizontal");
      document.getElementById("canvasdiv").classList.add("split-horizontal");
      document.getElementById("frontcanvas").classList.remove("split-horizontal");
      document.getElementById("backcanvas").classList.remove("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        direction: "vertical",
        onDragEnd: resizeAll
      });
  }
  settings.bomlayout = layout;
  writeStorage("bomlayout", layout);
  changeCanvasLayout(settings.canvaslayout);
}

function changeBomMode(mode) {
  document.getElementById("bom-grouped-btn").classList.remove("depressed");
  document.getElementById("bom-ungrouped-btn").classList.remove("depressed");
  document.getElementById("bom-netlist-btn").classList.remove("depressed");
  var chkbxs = document.getElementsByClassName("visibility_checkbox");

  switch (mode) {
    case 'grouped':
      document.getElementById("bom-grouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'ungrouped':
      document.getElementById("bom-ungrouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'netlist':
      document.getElementById("bom-netlist-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = true;
      }
  }

  writeStorage("bommode", mode);
  if (mode != settings.bommode) {
    settings.bommode = mode;
    bomSortFunction = null;
    currentSortColumn = null;
    currentSortOrder = null;
    clearHighlightedFootprints();
  }
  populateBomTable();
}

function focusFilterField() {
  focusInputField(document.getElementById("filter"));
}

function focusRefLookupField() {
  focusInputField(document.getElementById("reflookup"));
}

function toggleBomCheckbox(bomrowid, checkboxnum) {
  if (!bomrowid || checkboxnum > settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum].childNodes[0];
  checkbox.checked = !checkbox.checked;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function checkBomCheckbox(bomrowid, checkboxname) {
  var checkboxnum = 0;
  while (checkboxnum < settings.checkboxes.length &&
    settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
    checkboxnum++;
  }
  if (!bomrowid || checkboxnum >= settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum + 1].childNodes[0];
  checkbox.checked = true;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function setBomCheckboxes(value) {
  writeStorage("bomCheckboxes", value);
  settings.checkboxes = value.split(",").map((e) => e.trim()).filter((e) => e);
  prepCheckboxes();
  populateMarkWhenCheckedOptions();
  setMarkWhenChecked(settings.markWhenChecked);
}

function setMarkWhenChecked(value) {
  writeStorage("markWhenChecked", value);
  settings.markWhenChecked = value;
  markedFootprints.clear();
  for (var ref of (value ? getStoredCheckboxRefs(value) : [])) {
    markedFootprints.add(ref);
  }
  populateBomTable();
  drawHighlights();
}

function prepCheckboxes() {
  var table = document.getElementById("checkbox-stats");
  while (table.childElementCount > 1) {
    table.removeChild(table.lastChild);
  }
  if (settings.checkboxes.length) {
    table.style.display = "";
  } else {
    table.style.display = "none";
  }
  for (var checkbox of settings.checkboxes) {
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    td.innerHTML = checkbox;
    tr.appendChild(td);
    td = document.createElement("TD");
    td.id = "checkbox-stats-" + checkbox;
    var progressbar = document.createElement("div");
    progressbar.classList.add("bar");
    td.appendChild(progressbar);
    var text = document.createElement("div");
    text.classList.add("text");
    td.appendChild(text);
    tr.appendChild(td);
    table.appendChild(tr);
    updateCheckboxStats(checkbox);
  }
}

function populateMarkWhenCheckedOptions() {
  var container = document.getElementById("markWhenCheckedContainer");

  if (settings.checkboxes.length == 0) {
    container.parentElement.style.display = "none";
    return;
  }

  container.innerHTML = '';
  container.parentElement.style.display = "inline-block";

  function createOption(name, displayName) {
    var id = "markWhenChecked-" + name;

    var div = document.createElement("div");
    div.classList.add("radio-container");

    var input = document.createElement("input");
    input.type = "radio";
    input.name = "markWhenChecked";
    input.value = name;
    input.id = id;
    input.onchange = () => setMarkWhenChecked(name);
    div.appendChild(input);

    // Preserve the selected element when the checkboxes change
    if (name == settings.markWhenChecked) {
      input.checked = true;
    }

    var label = document.createElement("label");
    label.innerHTML = displayName;
    label.htmlFor = id;
    div.appendChild(label);

    container.appendChild(div);
  }
  createOption("", "None");
  for (var checkbox of settings.checkboxes) {
    createOption(checkbox, checkbox);
  }
}

function updateCheckboxStats(checkbox) {
  var checked = getStoredCheckboxRefs(checkbox).size;
  var total = pcbdata.footprints.length - pcbdata.bom.skipped.length;
  var percent = checked * 100.0 / total;
  var td = document.getElementById("checkbox-stats-" + checkbox);
  td.firstChild.style.width = percent + "%";
  td.lastChild.innerHTML = checked + "/" + total + " (" + Math.round(percent) + "%)";
}

function constrain(number, min, max) {
  return Math.min(Math.max(parseInt(number), min), max);
}

document.onkeydown = function (e) {
  switch (e.key) {
    case "n":
      if (document.activeElement.type == "text") {
        return;
      }
      if (currentHighlightedRowId !== null) {
        checkBomCheckbox(currentHighlightedRowId, "placed");
        highlightNextRow();
        e.preventDefault();
      }
      break;
    case "ArrowUp":
      highlightPreviousRow();
      e.preventDefault();
      break;
    case "ArrowDown":
      highlightNextRow();
      e.preventDefault();
      break;
    case "ArrowLeft":
    case "ArrowRight":
      if (document.activeElement.type != "text") {
        e.preventDefault();
        let boardRotationElement = document.getElementById("boardRotation")
        settings.boardRotation = parseInt(boardRotationElement.value);  // degrees / 5
        if (e.key == "ArrowLeft") {
          settings.boardRotation += 3;  // 15 degrees
        }
        else {
          settings.boardRotation -= 3;
        }
        settings.boardRotation = constrain(settings.boardRotation, boardRotationElement.min, boardRotationElement.max);
        boardRotationElement.value = settings.boardRotation
        setBoardRotation(settings.boardRotation);
      }
      break;
    default:
      break;
  }
  if (e.altKey) {
    switch (e.key) {
      case "f":
        focusFilterField();
        e.preventDefault();
        break;
      case "r":
        focusRefLookupField();
        e.preventDefault();
        break;
      case "z":
        changeBomLayout("bom-only");
        e.preventDefault();
        break;
      case "x":
        changeBomLayout("left-right");
        e.preventDefault();
        break;
      case "c":
        changeBomLayout("top-bottom");
        e.preventDefault();
        break;
      case "v":
        changeCanvasLayout("F");
        e.preventDefault();
        break;
      case "b":
        changeCanvasLayout("FB");
        e.preventDefault();
        break;
      case "n":
        changeCanvasLayout("B");
        e.preventDefault();
        break;
      default:
        break;
    }
    if (e.key >= '1' && e.key <= '9') {
      toggleBomCheckbox(currentHighlightedRowId, parseInt(e.key));
      e.preventDefault();
    }
  }
}

function hideNetlistButton() {
  document.getElementById("bom-ungrouped-btn").classList.remove("middle-button");
  document.getElementById("bom-ungrouped-btn").classList.add("right-most-button");
  document.getElementById("bom-netlist-btn").style.display = "none";
}

function topToggle() {
  var top = document.getElementById("top");
  var toptoggle = document.getElementById("toptoggle");
  if (top.style.display === "none") {
    top.style.display = "flex";
    toptoggle.classList.remove("flipped");
  } else {
    top.style.display = "none";
    toptoggle.classList.add("flipped");
  }
}

window.onload = function (e) {
  initUtils();
  initRender();
  initStorage();
  initDefaults();
  cleanGutters();
  populateMetadata();
  dbgdiv = document.getElementById("dbg");
  bom = document.getElementById("bombody");
  bomhead = document.getElementById("bomhead");
  filter = "";
  reflookup = "";
  if (!("nets" in pcbdata)) {
    hideNetlistButton();
  }
  initDone = true;
  setBomCheckboxes(document.getElementById("bomCheckboxes").value);
  // Triggers render
  changeBomLayout(settings.bomlayout);

  // Users may leave fullscreen without touching the checkbox. Uncheck.
  document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement)
      document.getElementById('fullscreenCheckbox').checked = false;
  });
}

window.onresize = resizeAll;
window.matchMedia("print").addListener(resizeAll);

///////////////////////////////////////////////

///////////////////////////////////////////////
// EventHandler.registerCallback(IBOM_EVENT_TYPES.BOM_BODY_CHANGE_EVENT, () => {
//     for(var tr of bom.childNodes) {
//         tr.onclick = tr.onmousemove;
//         tr.onmousemove = null;
//     };
// });

///////////////////////////////////////////////
  </script>
</head>

<body>

<div id="topmostdiv" class="topmostdiv">
  <div id="top">
    <div id="fileinfodiv">
      <table class="fileinfo">
        <tbody>
          <tr>
            <td id="title" class="title" style="width: 70%">
              Title
            </td>
            <td id="revision" class="title" style="width: 30%">
              Revision
            </td>
          </tr>
          <tr>
            <td id="company">
              Company
            </td>
            <td id="filedate">
              Date
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div id="bomcontrols">
      <div class="hideonprint menu">
        <button class="menubtn"></button>
        <div class="menu-content">
          <label class="menu-label menu-label-top" style="width: calc(50% - 18px)">
            <input id="darkmodeCheckbox" type="checkbox" onchange="setDarkMode(this.checked)">
            Dark mode
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label menu-label-top" style="width: calc(50% - 17px); border-left: 0;">
            <input id="fullscreenCheckbox" type="checkbox" onchange="setFullscreen(this.checked)">
            Full Screen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="fabricationCheckbox" type="checkbox" checked onchange="fabricationVisible(this.checked)">
            Fab layer
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="silkscreenCheckbox" type="checkbox" checked onchange="silkscreenVisible(this.checked)">
            Silkscreen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="referencesCheckbox" type="checkbox" checked onchange="referencesVisible(this.checked)">
            References
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="valuesCheckbox" type="checkbox" checked onchange="valuesVisible(this.checked)">
            Values
          </label>
          <div id="tracksAndZonesCheckboxes">
            <label class="menu-label" style="width: calc(50% - 18px)">
              <input id="tracksCheckbox" type="checkbox" checked onchange="tracksVisible(this.checked)">
              Tracks
            </label><!-- This comment eats space! All of it!
            --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
              <input id="zonesCheckbox" type="checkbox" checked onchange="zonesVisible(this.checked)">
              Zones
            </label>
          </div>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="padsCheckbox" type="checkbox" checked onchange="padsVisible(this.checked)">
            Pads
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="dnpOutlineCheckbox" type="checkbox" checked onchange="dnpOutline(this.checked)">
            DNP outlined
          </label>
          <label class="menu-label">
            <input id="dragCheckbox" type="checkbox" checked onchange="setRedrawOnDrag(this.checked)">
            Continuous redraw on drag
          </label>
          <label class="menu-label">
            Highlight first pin
            <form id="highlightpin1">
              <div class="flexbox">
                <label>
                  <input type="radio" name="highlightpin1" value="none" onchange="setHighlightPin1('none')">
                  None
                </label>
                <label>
                  <input type="radio" name="highlightpin1" value="all" onchange="setHighlightPin1('all')">
                  All
                </label>
                <label>
                  <input type="radio" name="highlightpin1" value="selected" onchange="setHighlightPin1('selected')">
                  Selected
                </label>
              </div>
            </form>
          </label>
          <label class="menu-label">
            <span>Board rotation</span>
            <span style="float: right"><span id="rotationDegree">0</span>&#176;</span>
            <input id="boardRotation" type="range" min="-36" max="36" value="0" class="slider" oninput="setBoardRotation(this.value)">
          </label>
          <label class="menu-label">
            <input id="offsetBackRotationCheckbox" type="checkbox" onchange="setOffsetBackRotation(this.checked)">
            Offset back rotation
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Bom checkboxes</div>
            <input id="bomCheckboxes" class="menu-textbox" type=text
                   oninput="setBomCheckboxes(this.value)">
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Mark when checked</div>
            <div id="markWhenCheckedContainer"></div>
          </label>
          <label class="menu-label">
            <span class="shameless-plug">
              <span>Created using</span>
              <a id="github-link" target="blank" href="https://github.com/openscopeproject/InteractiveHtmlBom">InteractiveHtmlBom</a>
              <a target="blank" title="Mouse and keyboard help" href="https://github.com/openscopeproject/InteractiveHtmlBom/wiki/Usage#bom-page-mouse-actions" style="text-decoration: none;"><label class="help-link">?</label></a>
            </span>
          </label>
        </div>
      </div>
      <div class="button-container hideonprint">
        <button id="fl-btn" class="left-most-button" onclick="changeCanvasLayout('F')"
                title="Front only">F
        </button>
        <button id="fb-btn" class="middle-button" onclick="changeCanvasLayout('FB')"
                title="Front and Back">FB
        </button>
        <button id="bl-btn" class="right-most-button" onclick="changeCanvasLayout('B')"
                title="Back only">B
        </button>
      </div>
      <div class="button-container hideonprint">
        <button id="bom-btn" class="left-most-button" onclick="changeBomLayout('bom-only')"
                title="BOM only"></button>
        <button id="lr-btn" class="middle-button" onclick="changeBomLayout('left-right')"
                title="BOM left, drawings right"></button>
        <button id="tb-btn" class="right-most-button" onclick="changeBomLayout('top-bottom')"
                title="BOM top, drawings bot"></button>
      </div>
      <div class="button-container hideonprint">
        <button id="bom-grouped-btn" class="left-most-button" onclick="changeBomMode('grouped')"
                title="Grouped BOM"></button>
        <button id="bom-ungrouped-btn" class="middle-button" onclick="changeBomMode('ungrouped')"
                title="Ungrouped BOM"></button>
        <button id="bom-netlist-btn" class="right-most-button" onclick="changeBomMode('netlist')"
                title="Netlist"></button>
      </div>
      <div class="hideonprint menu">
        <button class="statsbtn"></button>
        <div class="menu-content">
          <table class="stats">
            <tbody>
              <tr>
                <td width="40%">Board stats</td>
                <td>Front</td>
                <td>Back</td>
                <td>Total</td>
              </tr>
              <tr>
                <td>Components</td>
                <td id="stats-components-front">~</td>
                <td id="stats-components-back">~</td>
                <td id="stats-components-total">~</td>
              </tr>
              <tr>
                <td>Groups</td>
                <td id="stats-groups-front">~</td>
                <td id="stats-groups-back">~</td>
                <td id="stats-groups-total">~</td>
              </tr>
              <tr>
                <td>SMD pads</td>
                <td id="stats-smd-pads-front">~</td>
                <td id="stats-smd-pads-back">~</td>
                <td id="stats-smd-pads-total">~</td>
              </tr>
              <tr>
                <td>TH pads</td>
                <td colspan=3 id="stats-th-pads">~</td>
              </tr>
            </tbody>
          </table>
          <table class="stats">
            <col width="40%"/><col />
            <tbody id="checkbox-stats">
              <tr>
                <td colspan=2 style="border-top: 0">Checkboxes</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="hideonprint menu">
        <button class="iobtn"></button>
        <div class="menu-content">
          <div class="menu-label menu-label-top">
            <div style="margin-left: 5px;">Save board image</div>
            <div class="flexbox">
              <input id="render-save-width" class="menu-textbox" type="text" value="1000" placeholder="Width"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
              <span>X</span>
              <input id="render-save-height" class="menu-textbox" type="text" value="1000" placeholder="Height"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
            </div>
            <label>
              <input id="render-save-transparent" type="checkbox">
              Transparent background
            </label>
            <div class="flexbox">
              <button class="savebtn" onclick="saveImage('F')">Front</button>
              <button class="savebtn" onclick="saveImage('B')">Back</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Config and checkbox state</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveSettings()">Export</button>
              <button class="savebtn" onclick="loadSettings()">Import</button>
              <button class="savebtn" onclick="resetSettings()">Reset</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Save bom table as</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveBomTable('csv')">csv</button>
              <button class="savebtn" onclick="saveBomTable('txt')">txt</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="topdivider">
    <div class="hideonprint">
      <div id="toptoggle" onclick="topToggle()"></div>
    </div>
  </div>
  <div id="bot" class="split" style="flex: 1 1">
    <div id="bomdiv" class="split split-horizontal">
      <div style="width: 100%">
        <input id="reflookup" class="textbox searchbox reflookup hideonprint" type="text" placeholder="Ref lookup"
               oninput="updateRefLookup(this.value)">
        <input id="filter" class="textbox searchbox filter hideonprint" type="text" placeholder="Filter"
               oninput="updateFilter(this.value)">
        <div class="button-container hideonprint" style="float: left; margin: 0;">
          <button id="copy" title="Copy bom table to clipboard"
               onclick="saveBomTable('clipboard')"></button>
        </div>
      </div>
      <div id="dbg"></div>
      <table class="bom" id="bomtable">
        <thead id="bomhead">
        </thead>
        <tbody id="bombody">
        </tbody>
      </table>
    </div>
    <div id="canvasdiv" class="split split-horizontal">
      <div id="frontcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="F_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="F_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="F_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="F_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
      <div id="backcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="B_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="B_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="B_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="B_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

</body>

</html>
